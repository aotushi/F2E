## 操作符

**操作符**:包括数学操作符,位操作符,关系操作符和相等操作符等.

**操作符应用范围**: 用于各种值,包括字符串,数值,布尔值,甚至对象.

注意:在应用给对象时,操作符通常会调用valueOf()或toString()方法取得可以计算的值.



### 3.5.1 一元操作符

#### 1.递增/递减操作符

都有两个版本:前缀版和后缀版. 前缀版是操作符位于要操作变量的前面,后缀版是操作符位于操作变量的后面.

递增操作符: 双加号(++);  递减操作符: 双减号(--);

前加加: 变量立即递增1, ++a的值是变量自增后的值

后加加: 变量立即递增1, a++的值是变量自增前的值

```js
let age = 29;
let anotherAge = --age + 2;

console.log(age);//28
console.log(anotherAge); //30
```



操作符与其他操作混用时,差异会变明显:

```js
let num1 = 2;
let num2 = 20;
let num3 = num1-- + num2;
let num4 = num1 + num2;

console.log(num3); //22
console.log(num4); //21
```



**使用范围:**

不限于整数, 字符串,布尔值,浮点值,对象

**遵循规则:**

字符串: 如果是有效数值形式,则转换为数值再应用改变. 变量类型从字符串变成数值.

字符串: 如果不是有效数值形式,将变量值设置为NaN.变量类型从字符串变为数值.

布尔值: 如果是false,则转换为0再应用改变. 类型从布尔值变成数值.

布尔值: 如果是true,则转换为1再应用改变. 类型从布尔值变成数值.

浮点值: 加1或减1

对象: 调用valueOf()方法取得可操作的值.对得到的值应用上述的规则.如果是NaN,则调用toString()并再次应用其他规则.变量类型从对象变为数值.

```js
let s1 = '2';
let s2 = 'z';
let b = false;
let f = 1.1;
let o = {
  valueOf(){return -1};
}

s1++; //值变成数值3
s2++; //值变成数值NaN
b++; //值变成数值1
f--; //值变成0.10000000000000009(因为浮点数不精确)
o--; //值变成数值-2
```



#### 2. 一元加/一元减

**2.1 作用:**

1.数学运算

2.类型转换

**2.2 一元加**

**一元加**放在变量前面,对数值没有任何影响,但对非数值来说会执行与Number()转型函数一样的类型转换:

布尔值false: 0

布尔值true: 1

字符串: 数值类型和非数值类型

对象: 调用valueOf()和/或toString()方法得到转换的值.

**2.3 一元减**

一元减由一个减号(-)表示,放在变量前面.主要用于把数值变成负值.

对数值使用一元减会将其变成相应的负值（如上面的例子所示）。在应用到非数值时，一元减会遵循与一元加同样的规则，先对它们进行转换，然后再取负值：



### 3.5.2 位操作符 //



### 3.5.3 布尔操作符

#### 1. 介绍

布尔操作符一共有3 个：逻辑非、逻辑与和逻辑或

#### 2. 逻辑非

逻辑非操作符由一个叹号（!）表示，可应用给ECMAScript 中的任何值。这个操作符始终返回布尔值，无论应用到的是什么数据类型。逻辑非操作符首先将操作数转换为布尔值，然后再对其取反。

 遵循如下规则:

| 操作数类型            | 返回布尔值 |
| --------------------- | ---------- |
| 对象                  | false      |
| 非空字符串            | false      |
| 非0数值(包括Infinity) | false      |
| 空字符串              | true       |
| 0                     | true       |
| null                  | true       |
| NaN                   | true       |
| undefined             | true       |



**类型转换**

同时使用两个叹号（!!），相当于调用了转型函数Boolean()。无论操作数是什么类型，第一个叹号总会返回布尔值。第二个叹号对该布尔值取反，从而给出变量真正对应的布尔值



#### 3. 逻辑与

逻辑与操作符由两个和号（&&）表示，应用到两个值

逻辑与操作符是一种**短路操作符**，意思就是如果第一个操作数决定了结果，那么永远不会对第二个操作数求值。对逻辑与操作符来说，如果第一个操作数是false，那么无论第二个操作数是什么值，结果也不可能等于true。

遵循如下规则: 两侧都是true才返回true

| 第一个操作数 | 第二个操作数 | 结果  |
| ------------ | ------------ | ----- |
| true         | true         | true  |
| true         | false        | false |
| false        | true         | false |
| false        | false        | false |

逻辑与操作符可用于任何类型的操作数，不限于布尔值。如果有操作数不是布尔值，则逻辑与并不一定会返回布尔值，而是遵循如下规则。逻辑与是用来找false的.

 如果第一个操作数是对象，则返回第二个操作数。
 如果第二个操作数是对象，则只有第一个操作数求值为true 才会返回该对象。
 如果两个操作数都是对象，则返回第二个操作数。
 如果有一个操作数是null，则返回null。
 如果有一个操作数是NaN，则返回NaN。
 如果有一个操作数是undefined，则返回undefined







#### 4. 逻辑或

逻辑或操作符由两个管道符（||）表示,遵循如下规则:

| 第一个操作数 | 第二个操作数 | 结果  |
| ------------ | ------------ | ----- |
| true         | true         | true  |
| true         | false        | true  |
| false        | true         | true  |
| false        | false        | false |

与逻辑与类似，如果有一个操作数不是布尔值，那么逻辑或操作符也不一定返回布尔值。它遵循如下规则。(逻辑或是来找true的.)

 如果第一个操作数是对象，则返回第一个操作数。
 如果第一个操作数求值为false，则返回第二个操作数。
 如果两个操作数都是对象，则返回第一个操作数。
 如果两个操作数都是null，则返回null。
 如果两个操作数都是NaN，则返回NaN。
 如果两个操作数都是undefined，则返回undefined

对逻辑或而言，第一个操作数求值为true，第二个操作数就不会再被求值了

**特性应用-变量赋值**

可以避免给变量赋值null 或undefined

```js
let myObj = preferOjbect || backupObject;

//解析:
1.变量myObject 会被赋予两个值中的一个
2.preferOjbect是首选的值,backupObject是备用值
3.如果preferObject是null,则backupObject的值会被赋给myObj.
```



### 3.5.4 乘性操作符

ECMAScript 定义了3 个乘性操作符：乘法、除法和取模. 但在处理非数值时，它们也会包含一些自动的类型转换.如果乘性操作符有
不是数值的操作数，则该操作数会在后台被使用Number()转型函数转换为数值



#### 1.乘法操作符

乘法操作符由一个星号（*）表示，可以用于计算两个数值的乘积

```js
let result = 34 * 56;
```

处理特殊值时遵循的规则:

* 如果ECMAScript 不能表示乘积，则返回Infinity 或-Infinity
* 如果有任一操作数是NaN，则返回NaN
* 如果是Infinity 乘以0，则返回NaN
* 如果是Infinity 乘以非0 的有限数值，则根据第二个操作数的符号返回Infinity 或-Infinity
* 如果是Infinity 乘以Infinity，则返回Infinity
* 如果有不是数值的操作数，则先在后台用Number()将其转换为数值，然后再应用上述规则



#### 2.除法操作符

除法操作符由一个斜杠（/）表示，用于计算第一个操作数除以第二个操作数的商

```js
被除数 / 除数 = 商;
let result = 66 / 11;
```



针对特殊值由一些特殊的行为:

* 如果ECMAScript不能表示商，则返回Infinity 或-Infinity
* 如果有任一操作数是NaN，则返回NaN
* 如果是Infinity 除以Infinity，则返回NaN
* 如果是0 除以0，则返回NaN
* 如果是非0 的有限值除以0，则根据第一个操作数的符号返回Infinity 或-Infinity; 非0数值除以Infinity/-Infinity,返回0/-0.
* 如果是Infinity 除以任何数值，则根据第二个操作数的符号返回Infinity 或-Infinity; 
* 如果有不是数值的操作数，则先在后台用Number()函数将其转换为数值，然后再应用上述规则



#### 3.取模操作符

取模（余数）操作符由一个百分比符号（%）表示

```js
let result = 26 % 5; //等于1
```



取模操作符对特殊值也有一些特殊的行为:

* 如果操作数是数值，则执行常规除法运算，返回余数
* 如果被除数是无限值，除数是有限值，则返回NaN
* 如果被除数是有限值，除数是0，则返回NaN
* 如果是Infinity 除以Infinity，则返回NaN。
* 如果被除数是有限值，除数是无限值，则返回被除数
* 如果被除数是0，除数不是0，则返回0
* 如果有不是数值的操作数，则先在后台用Number()函数将其转换为数值，然后再应用上述规则



### 3.5.5 指数操作符

ECMAScript 7 新增了指数操作符，Math.pow()现在有了自己的操作符**

```js
console.log(Math.pow(3,2)); //9
console.log(3**2); //9

console.log(Math.pow(16, 0.5)); //4
console.log(16**.5); //4
```



指数操作符也有自己的指数赋值操作符**=，该操作符执行指数运算和结果的赋值操作

```js
let squared = 3;
squared **= 2;
console.log(squared); //9
```



### 3.5.6 加性操作符

加性操作符，即加法和减法操作符,与乘性操作符类似，加性操作符在后台会发生不同数据类型的转换。

#### 1.加法操作符

加法操作符（+）用于求两个数的和

```js
let result = 1 + 2;
```

如果**两个操作数都是数值**，加法操作符执行加法运算并根据如下规则返回结果:

 如果有任一操作数是NaN，则返回NaN；
 如果是Infinity 加Infinity，则返回Infinity；
 如果是-Infinity 加-Infinity，则返回-Infinity；
 如果是Infinity 加-Infinity，则返回NaN；
 如果是+0 加+0，则返回+0；
 如果是-0 加+0，则返回+0；
 如果是-0 加-0，则返回-0

如果有一个操作数是**字符串**，则要应用如下规则

* 如果两个操作数都是字符串，则将第二个字符串拼接到第一个字符串后面
* 如果只有一个操作数是字符串，则将另一个操作数转换为字符串，再将两个字符串拼接在一起。
* 如果有任一操作数是对象、数值或布尔值，则调用它们的**toString()方法**以获取字符串，然后再应用前面的关于字符串的规则
* 对于undefined 和null，则调用**String()函数**，分别获取"undefined"和"null"

```js
let num1 = 5;
let num2 = 10;
let msg = 'the sum of 5 and 10 is' + num1 + num2;
console.log(msg); //"The sum of 5 and 10 is 510"

let msg = 'the sum of 5 and 10 is' + (num1 + num2); 
//括号让解释器先执行两个数值的加法，然后再把结果追加给字符串
console.log(msg); //"The sum of 5 and 10 is 15"
```



#### 2.减法操作符

减法操作符也有一组规则用于处理ECMAScript 中不同类型之间的转换

 如果两个操作数都是数值，则执行数学减法运算并返回结果。
 如果有任一操作数是NaN，则返回NaN。
 如果是Infinity 减Infinity，则返回NaN。
 如果是-Infinity 减-Infinity，则返回NaN。
 如果是Infinity 减-Infinity，则返回Infinity。
 如果是-Infinity 减Infinity，则返回-Infinity。
 如果是+0 减+0，则返回+0。
 如果是+0 减-0，则返回-0。
 如果是-0 减-0，则返回+0。
 如果有任一操作数是字符串、布尔值、null 或undefined，则先在后台使用Number()将其转换为数值，然后再根据前面的规则执行数学运算。如果转换结果是NaN，则减法计算的结果是NaN。
 如果有任一操作数是对象，则调用其valueOf()方法取得表示它的数值。如果该值是NaN，则减法计算的结果是NaN。如果对象没有valueOf()方法，则调用其toString()方法，然后再将得到的字符串转换为数值。



### 3.5.7 关系操作符

关系操作符执行比较两个值的操作，包括小于（<）、大于（>）、小于等于（<=）和大于等于（>=）,这几个操作符都返回布尔值.

与ECMAScript 中的其他操作符一样，在将它们应用到不同数据类型时也会发生类型转换和其他行为.(发生类型转换的有数值/布尔值)

 如果操作数都是数值，则执行数值比较。
 如果操作数都是字符串，则逐个比较字符串中对应字符的编码。
 如果有任一操作数是数值，则将另一个操作数转换为数值，执行数值比较。
 如果有任一操作数是对象，则调用其valueOf()方法，取得结果后再根据前面的规则执行比较。
	如果没有valueOf()操作符，则调用toString()方法，取得结果后再根据前面的规则执行比较。
 如果有任一操作数是布尔值，则将其转换为数值再执行比较。

```js
let obj = {a:1,b:2};
obj<'a'; //true
```



对字符串而言，关系操作符会比较字符串中对应字符的编码，而这些编码是数值。比较完之后，会返回布尔值。问题的关键在于，大写字母的编码都小于小写字母的编码

```js
let result = 'Brick' < 'apphabet'; //true
```

要得到确实按字母顺序比较的结果，就必须把两者都转换为相同的大小写形式(全大写或全小写),然后再比较

```js
let result = 'Brick'.toLowerCase() < 'alphabet'.toLowerCase(); //false
```

只要是数值和字符串比较，字符串就会先被转换为数值，然后进行数值比较.

```js
let result = 'a'<3; //因为"a"会转换为NaN，所以结果是false
```

这里有一个规则，即任何关系操作符在涉及比NaN时都返false.

```js
let result = NaN < 3; //false
let result2 = NaN >= 3; //false
```



### 3.5.8 相等操作符

ECMAScript提供了两组操作符。第一组是**等于和不等于**，它们在比较之前执行类型转换。第二组是**全等和不全等**，它们在比较之前不执行转换。

#### 1. 等于和不等于

**等于操作符**用两个等于号（==）表示,如果操作数相等，则会返回true;

**不等于操作符**用叹号和等于号（!=）表示，如果两个操作数不相等，则会返回true

这两个操作符都会先进行类型转换（通常称为强制类型转换）再确定操作数是否相等.



转换操作数类型,相等操作符遵循如下规则:

* 如果任一操作数是布尔值，则将其转换为数值再比较是否相等。false 转换为0，true 转换为1。
* 如果一个操作数是字符串，另一个操作数是数值，则尝试将字符串转换为数值，再比较是否相等。
* 如果一个操作数是对象，另一个操作数不是，则调用对象的valueOf()方法取得其原始值，再根据前面的规则进行比较。

在进行比较时，这两个操作符会遵循如下规则

* null 和undefined 相等。
* null 和undefined 不能转换为其他类型的值再进行比较。
* 如果有任一操作数是NaN，则相等操作符返回false，不相等操作符返回true。记住：即使两个操作数都是NaN，相等操作符也返回false，因为按照规则，NaN 不等于NaN。
* 如果两个操作数都是对象，则比较它们是不是同一个对象。如果两个操作数都指向同一个对象，则相等操作符返回true。否则，两者不相等。

| 表达式                                      | 结果  |
| ------------------------------------------- | ----- |
| null == undefined                           | true  |
| 'NaN' == NaN                                | false |
| 5 == NaN                                    | false |
| NaN == NaN                                  | false |
| NaN !== NaN                                 | true  |
| false == 0                                  | true  |
| true == 1                                   | true  |
| true == 2                                   | false |
| undefined == 0                              | false |
| null == 0  //null不能转换为其他类型值再比较 | false |
| '5' == 5                                    | true  |



#### 2.全等和全不等

全等操作符由3 个等于号（===）表示，只有两个操作数在不转换的前提下相等才返回true.

不全等操作符用一个叹号和两个等于号（!==）表示，只有两个操作数在不转换的前提下不相等才返回true

```js
null === undefined; //false
```

note: 由于相等和不相等操作符存在类型转换问题，因此推荐使用全等和不全等操作符。这样有助于在代码中保持数据类型的完整性



### 3.5.9 条件操作符

条件操作符是ECMAScript 中用途最为广泛的操作符之一，语法跟Java 中一样

variable = boolean_expression ? true_value : false_value;

上面的代码执行了条件赋值操作，即根据条件表达式boolean_expression 的值决定将哪个值赋给变量variable 。如果boolean_expression 是true ， 则赋值true_value ； 如果boolean_expression 是false，则赋值false_value。



###  3.5.10 赋值操作符

#### 1. 简单赋值

简单赋值用等于号（=）表示，将右手边的值赋给左手边的变量

```js
let num = 10;
```



#### 2. 复合赋值

复合赋值使用乘性、加性或位操作符后跟等于号（=）表示

```js
let num = 10;
num = num + 10;
```



#### 3. 类型

每个数学操作符以及其他一些操作符都有对应的复合赋值操作符

 乘后赋值（*=）
 除后赋值（/=）
 取模后赋值（%=）
 加后赋值（+=）
 减后赋值（-=）
 左移后赋值（<<=）
 右移后赋值（>>=）
 无符号右移后赋值（>>>=）



### 3.5.11 逗号操作符

逗号操作符可以用来在一条语句中执行多个操作

```js
let num1=1, num2=2, num3=3;
```

在一条语句中同时声明多个变量是逗号操作符最常用的场景。不过，也可以使用逗号操作符来辅助赋值。在赋值时使用逗号操作符分隔值，最终会返回表达式中最后一个值.

```js
let num = (5,1,4,8,0); //num的值为0
```



