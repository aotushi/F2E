---
alias:
---


### Promise介绍

#### 概述

> Promise 是异步编程的一种解决方案，比传统的解决方案——回调函数和事件——更合理和更强大。
>
> 所谓`Promise`，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。
> 从语法上说，Promise 是一个对象，可以获取异步操作的消息。

#### 类比

> 你是一位歌手, 你承诺（promise）会在单曲发布(结果)的第一时间发给他们。
> 你给了粉丝们一个列表。他们可以在上面填写他们的电子邮件地址，以便当歌曲发布后，让所有订阅了的人能够立即收到。
> 即便遇到不测，例如录音室发生了火灾，以致你无法发布新歌，他们也能及时收到相关通知



#### 作用

ES6推出的新的更好的异步编程解决方案(相对于纯回调的方式)

- 在异步操作启动前或完成后, 再指定回调函数得到异步结果
- 解决嵌套回调的回调地狱问题  ---promise链式调用
- 可以处理多个异步请求并发. `Promise.all`的出现让我们可以更加方便的处理多个任务完成时在进行处理的逻辑。





#### 特点和缺点

**Promise对象有两个特点:**

* <u>对象的状态不受影响</u>
  * Promise对象代表一个异步操作,有3种状态: pending,fulfilled,rejected
  * 只有异步操作的结果,可以决定当前是哪一种状态,任何其他操作均无效.
* <u>一旦状态改变,就不会再发生变化.</u>
  * Promise状态改变,只有两种可能.从pending->fulfilled或从pending->rejected
  * 如果状态已改变(称为resolved,已定型).再对Promise对象添加回调,也会立即得到这个结果.

**Promise的缺点:**

* 无法取消Promise,一旦建立就会立即执行,无法中途取消.
* 如果不设置回调,Promise内部抛出的错误,不会反应到外部.
* 当处于pending状态时,无法得知目前进展到哪一步(刚开始还是即将完成)
* 单一值. 

Promise只能有一个完成值或拒绝原因,而在实际使用中,往往需要传递多个值,一般做法是构造一个对象或数组,然后再传递,then中获得这个值后,又会进行取值赋值的操作,每次封装和解封会让代码变的笨重. 建议使用ES6的解构赋值.

```javascript
Promise.all([Promise.resolve(1), Promise.resolve(2)])
.then(([x, y]) => {
  console.log(x, y);
})
```

