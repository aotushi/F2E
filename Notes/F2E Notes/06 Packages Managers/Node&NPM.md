## Nodejså­¦ä¹ æ•™ç¨‹

> https://www.zhihu.com/question/59212916/answer/273289677



\1. è®¤çœŸå­¦ä¹  ECMAScriptï¼Œå¹¶å­¦ä¼šå¦‚ä½•çœ‹ ECMAScript è§„èŒƒï¼›

\2. å­¦ä¼šçœ‹ Node.js APIï¼Œè€Œä¸æ˜¯å­¦ç€æ­»è®°ç¡¬èƒŒï¼Œå¹¶å¸¸çœ‹ç¤¾åŒºåŠ¨æ€ä»¥åŠ CHANGELOGï¼›

\3. å­¦ä¼šæœç´¢ Node.js ç”Ÿæ€åœˆï¼Œè€Œä¸æ˜¯æ­»è®°ç¡¬èƒŒè¦å­¦ä¼šæŸä¸ªæ¡†æ¶ï¼Œé‚£æ ·æ²¡ç”¨ï¼›

\4. åœ¨ä¼š Promise / yield / async å¤–ï¼Œè¿˜åº”è¯¥ä¸å¿˜å¥½å¥½å­¦ä¹  callbackï¼Œå¾ˆå¤šæ–°äººæŠŠè¿™å—é‡è¦çš„æ€æƒ³ç»™å¿½ç•¥äº†ï¼›

\5. å¤¯å®ç¼–ç¨‹åŸºç¡€ï¼Œä¸ Node.js æ— å…³ï¼Œå¦‚æ•°æ®ç»“æ„ã€è®¾è®¡æ¨¡å¼ã€æ“ä½œç³»ç»Ÿç­‰ç­‰ï¼Œè¿™äº›ä¸œè¥¿ä¼šäº†ä¹‹åä½ çš„æ€æƒ³å°±å¯¹äº†ï¼Œé€ è½®å­ä»€ä¹ˆçš„æ‰‹åˆ°æ“’æ¥ï¼›

\6. å­¦ä¹ æ•´ä¸ªåç«¯ä½“ç³»ï¼ŒåŒ…æ‹¬ä½†ä¸å±€é™äº HTTP åè®®ã€TCP ç­‰ç­‰ï¼Œè¿˜æœ‰æ•°æ®åº“ï¼ˆå¹¶ä¸æ˜¯å­¦ä¼šå¦‚ä½•å†™ SQLï¼Œè€Œæ˜¯æ•°æ®åº“åŸºç¡€ï¼‰ï¼›



ä½œè€…ï¼šæ­»æœˆçµ²å¡è•¾ç‰¹
é“¾æ¥ï¼šhttps://www.zhihu.com/question/59212916/answer/273289677
æ¥æºï¼šçŸ¥ä¹
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚



> [NodeSchool](https://nodeschool.io/zh-cn/)
>
> 





## Node.jså®‰è£…é…ç½®

### 1.ä¸‹è½½å®‰è£…Node.js

> å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼šhttps://nodejs.org/en/download/

å¯ä»¥ä¸‹è½½å®‰è£…åŒ…, æˆ–è€…ä¸‹è½½zipæ–‡ä»¶æ‰¾ä¸ªç›®å½•ä¿å­˜ï¼Œè§£å‹ä¸‹è½½çš„æ–‡ä»¶ï¼Œç„¶åé…ç½®ç¯å¢ƒå˜é‡ï¼Œå°†è§£å‹æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„é…ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚



### 2.é…ç½®é»˜è®¤å®‰è£…ç›®å½•å’Œç¼“å­˜æ—¥å¿—ç›®å½•

> è¿™é‡Œçš„ç¯å¢ƒé…ç½®ä¸»è¦é…ç½®çš„æ˜¯npmå®‰è£…çš„å…¨å±€æ¨¡å—æ‰€åœ¨çš„è·¯å¾„ï¼Œä»¥åŠç¼“å­˜cacheçš„è·¯å¾„ï¼Œä¹‹æ‰€ä»¥è¦é…ç½®ï¼Œæ˜¯å› ä¸ºä»¥ååœ¨æ‰§è¡Œç±»ä¼¼ï¼šnpm install express [-g] ï¼ˆåé¢çš„å¯é€‰å‚æ•°-gï¼Œgä»£è¡¨globalå…¨å±€å®‰è£…çš„æ„æ€ï¼‰çš„å®‰è£…è¯­å¥æ—¶ï¼Œä¼šå°†å®‰è£…çš„æ¨¡å—å®‰è£…åˆ°ã€C:\Users\ç”¨æˆ·å\AppData\Roaming\npmã€‘è·¯å¾„ä¸­ï¼Œå Cç›˜ç©ºé—´ã€‚

####  2.1 åˆ›å»ºé»˜è®¤å®‰è£…ç›®å½•å’Œç¼“å­˜æ—¥å¿—ç›®å½•

#### 1. åˆ›å»ºæ–‡ä»¶å¤¹

å¸Œæœ›å°†å…¨æ¨¡å—æ‰€åœ¨è·¯å¾„å’Œç¼“å­˜è·¯å¾„ï¼Œæ”¾åœ¨æˆ‘node.jså®‰è£…çš„æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ™åœ¨æˆ‘å®‰è£…çš„æ–‡ä»¶å¤¹ã€"D:\Program Files \nodejsã€‘ä¸‹åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ã€node_globalã€‘åŠã€node_cacheã€‘åˆ†åˆ«ä½œä¸ºé»˜è®¤å®‰è£…ç›®å½•å’Œç¼“å­˜æ—¥å¿—ç›®å½•ã€‚

#### 2.æ‰§è¡Œå‘½ä»¤

```shell
npm config set prefix "D:\Program Files\nodejs\node_global"
npm config set cache  "D:\Promgram Files\nodejs\node_cache"
```

è¾“å…¥`npm list -global`å‘½ä»¤æ¥æŸ¥çœ‹å…¨å±€å®‰è£…ç›®å½•ï¼š



### 3.node.jsç¯å¢ƒé…ç½®

> è¿™é‡Œé»˜è®¤æ˜¯D:\Program Files\nodejsä¸ºnodeçš„å®‰è£…è·¯å¾„
>
> å¦‚æœæ˜¯å®‰è£…å®‰è£…çš„,ç¯å¢ƒå˜é‡ä¼šè‡ªåŠ¨é…ç½®çš„

#### 1.è¿›å…¥ç¯å¢ƒå˜é‡é…ç½®

> æˆ‘çš„ç”µè„‘â€-å³é”®-â€œå±æ€§â€-â€œé«˜çº§ç³»ç»Ÿè®¾ç½®â€-â€œé«˜çº§â€-â€œç¯å¢ƒå˜é‡â€ï¼Œè¿›å…¥ç¯å¢ƒå˜é‡å¯¹è¯æ¡†

1ã€ã€ç³»ç»Ÿå˜é‡ã€‘ä¸‹æ–°å»ºã€NODE_PATHã€‘ï¼Œæ­¤å¤„è®¾ç½®ç¬¬ä¸‰æ–¹ä¾èµ–åŒ…å®‰è£…ç›®å½•
å¦‚æœè·Ÿç€ç¬¬2æ­¥ä¿®æ”¹äº†å…¨å±€å®‰è£…ç›®å½•ï¼Œåˆ™è¾“å…¥ã€D:\Program Files\nodejs\node_global\node_modules ã€‘

2ã€ã€ç³»ç»Ÿå˜é‡ã€‘ä¸‹çš„ã€Pathã€‘æ·»åŠ ä¸Šnodeçš„è·¯å¾„ã€D:\Program Files\nodejs\ã€‘

3ã€å¦‚æœè®¾ç½®äº†å…¨å±€å®‰è£…ç›®å½•ï¼Œã€ç”¨æˆ·å˜é‡ã€‘ä¸‹çš„ã€Pathã€‘å°†é»˜è®¤çš„ C ç›˜ä¸‹ APPData/Roaming\npm ä¿®æ”¹ä¸ºã€D:\Program Files\nodejs\node_globalã€‘ï¼Œã€D:\Program Files\nodejs\node_cacheã€‘ï¼Œè¿™æ˜¯nodejsé»˜è®¤çš„æ¨¡å—è°ƒç”¨è·¯å¾„



### 4.é…ç½®æ·˜å®é•œåƒ

#### æŸ¥çœ‹npmä¸‹è½½æº 

> npm config get registry

å°†npmçš„æ¨¡å—ä¸‹è½½ä»“åº“ä»é»˜è®¤çš„å›½å¤–ç«™ç‚¹æ”¹ä¸ºå›½å†…çš„ç«™ç‚¹ï¼Œè¿™æ ·ä¸‹è½½æ¨¡å—çš„é€Ÿåº¦æ‰èƒ½æ¯”è¾ƒå¿«ï¼Œç°åœ¨ç”¨çš„éƒ½æ˜¯æ·˜å®é•œåƒæºï¼ˆhttps://registry.npmmirror.orgï¼‰ï¼Œä½¿ç”¨æ·˜å®é•œåƒæºæœ‰ä¸¤ç§æ–¹å¼ï¼š

1ï¼‰ä¸´æ—¶ä½¿ç”¨

> npm --registry https://registry.npmmirror.org install cluster

è¿™ä¸ªä»£ç å°±æ˜¯åªåœ¨å®‰è£…clusterçš„ä½¿ç”¨æ·˜å®é•œåƒä¸‹è½½ï¼Œæ¯æ¬¡å®‰è£…ä¸€ä¸ªæ¨¡å—éƒ½ç”¨æŒºé•¿çš„ä»£ç ï¼Œæ¯”è¾ƒç¹çï¼Œæ‰€ä»¥æ¨èç¬¬äºŒç§æ–¹å¼ã€‚

2ï¼‰æ°¸ä¹…ä½¿ç”¨

è¿™é‡Œæœ‰ä¹Ÿä¸¤ç§é…ç½®é€‰æ‹©ï¼Œä¸€æ˜¯ç›´æ¥ä¿®æ”¹npmå‘½ä»¤çš„ä»“åº“åœ°å€ä¸ºæ·˜å®é•œåƒæºï¼Œå¦ä¸€ç§æ˜¯å®‰è£…cnpmå‘½ä»¤ã€‚

ç¬¬ä¸€ç§: ç›´æ¥ä¿®æ”¹npmçš„é»˜è®¤é…ç½®

> npm config set registry https://registry.npmmirror.org

éªŒè¯ï¼šé…ç½®åå¯ä»¥æ ¹æ® `npm config get registry`æˆ– `npm config list` å‘½ä»¤æŸ¥çœ‹npmä¸‹è½½æºæ˜¯å¦é…ç½®æˆåŠŸï¼Œ

ç¬¬äºŒç§: å®‰è£…cnpm

> npm i -g cnpm --registry=https://registry.npmmirror.org

éªŒè¯æ–¹å¼å˜æˆäº†`cnpm config get registry` æˆ– `cnpm config list`


## NRM
### nrmç®¡ç†å¤šä¸ªnpmé•œåƒåœ°å€
å…¨å±€å®‰è£…nrmå, å³å¯è®¾ç½®åˆ‡æ¢å¤šä¸ªé•œåƒåœ°å€
```bash
# å…¨å±€å®‰è£…
npm i -g nrm


# æ·»åŠ é•œåƒ
# nrm add <registry name> <registry url>
nrm add china-tower http://10.34.53.35:7001/


# ä½¿ç”¨é•œåƒ
nrm use china-tower

# å±•ç¤ºå½“å‰æ‰€æœ‰é•œåƒ
nrm ls

```

## NVM
### ä½¿ç”¨nvmç®¡ç†å¤šä¸ªnodejsç‰ˆæœ¬
> ä»¥ä¸‹å†…å®¹æ˜¯ä»“åº“åœ°å€github.com/nvm-sh/nvmä¸‹çš„.
> ç›®å‰ä½¿ç”¨çš„æ˜¯https://github.com/coreybutler/nvm-windows å…·ä½“æ•™ç¨‹æŸ¥çœ‹ä»“åº“åœ°å€


NVMå°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½ç”¨nodeç®¡ç†å·¥å…·ï¼Œåˆ‡æ¢nodeç‰ˆæœ¬ã€‚ 

å®˜ç½‘æ•™ç¨‹

```bash
https://github.com/nvm-sh/nvm#usage
```



### é…ç½®æ•™ç¨‹

#### 0. åˆ é™¤å·²å®‰è£…çš„nodejs

å®Œæ•´æ¸…æ¥šå·²å®‰è£…çš„nodejs,åŒ…æ‹¬æ–‡ä»¶å¤¹å’Œç¯å¢ƒå˜é‡ä¸­çš„é…ç½®

å…·ä½“å¯ä»¥å‚è€ƒä¸‹é¢è¿æ¥ä¸­çš„å†…å®¹:

> [nodeå½»åº•åˆ é™¤_qq_45353152çš„åšå®¢-CSDNåšå®¢_å¸è½½node](https://blog.csdn.net/qq_45353152/article/details/124611034)



#### 1. ä¸‹è½½nvmå®‰è£…åŒ…

##### ä½¿ç”¨å®‰è£…åŒ…

* å®‰è£…ç‰ˆæœ¬ä½¿ç”¨æœ€æ–°
* ç‚¹å‡»æ‰§è¡Œexeæ–‡ä»¶, æ³¨æ„ä¿®æ”¹nvmçš„å®‰è£…æ ¹ç›®å½•ä»¥åŠnodeçš„å®‰è£…æ ¹ç›®å½•ï¼Œåè€…æ˜¯ä»¥åç®¡ç†å¤šç‰ˆæœ¬nodeçš„æºæ–‡ä»¶å‚¨å­˜åœ°å€

##### ä½¿ç”¨å‘½ä»¤è¡Œ

> [GitHub - nvm-sh/nvm: Node Version Manager - POSIX-compliant bash script to manage multiple active node.js versions](https://github.com/nvm-sh/nvm#usage)

åœ¨gitä¸­ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…, å®‰è£…ä»¥ååœ¨gitä¸­å¯ä»¥æŸ¥çœ‹,ä½†åœ¨cmdç¯å¢ƒä¸­æŠ¥é”™,æ— æ³•è¯†åˆ«nvmå‘½ä»¤.



å®‰è£…æƒ…å†µ

å®‰è£…å®Œæˆå, åœ¨cmdå‘½ä»¤è¡Œçª—å£ä¸­æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ

* `nvm version` æ£€æŸ¥nvmæ˜¯å¦å®‰è£…æˆåŠŸ





#### 2.ç®¡ç†nodejs

**æ³¨æ„:**åœ¨1.1.9ç‰ˆæœ¬ä¸­, å…ˆå‰å®‰è£…çš„ç‰ˆæœ¬æ²¡æœ‰åˆ é™¤,ä½†æ˜¯ä½¿ç”¨`nvm use ç‰ˆæœ¬å·`ä¸­ä¼šæŠ¥é”™. å¿…é¡»å…ˆå¸è½½ä¹‹å‰å®‰è£…çš„nodejs,åˆ é™¤å…¶å®‰è£…æ–‡ä»¶å¤¹. 

##### æŸ¥çœ‹å·²å®‰è£…çš„ç‰ˆæœ¬ç‰ˆæœ¬

```bash
nvm list
```



##### æŸ¥çœ‹å¯å®‰è£…çš„ç‰ˆæœ¬

```bash
nvm list available
```

##### å®‰è£…æŒ‡å®šç‰ˆæœ¬

```bash
nvm install ç‰ˆæœ¬å·

//å¦‚æœåªå†™å¤§çš„ç‰ˆæœ¬å·,é‚£ä¹ˆä¼šå®‰è£…å½“å‰ç‰ˆæœ¬å·çš„æœ€æ–°ç‰ˆæœ¬; ltsè¡¨ç¤ºæœ€æ–°ç‰ˆæœ¬
```



##### æŒ‡å®šnodeç‰ˆæœ¬

```bash
nvm use ç‰ˆæœ¬å·
```



##### å¸è½½æŒ‡å®šçš„ç‰ˆæœ¬

```bash
nvm uninstall ç‰ˆæœ¬å·
```



#### å…¶ä»–å‘½ä»¤

- nvm archï¼šè¡¨ç¤ºnodeæ˜¯è¿è¡Œåœ¨32ä½è¿˜æ˜¯64ä½ã€‚
- nvm on ï¼šå¼€å¯node.jsç‰ˆæœ¬ç®¡ç†ã€‚
- nvm offï¼šå…³é—­node.jsç‰ˆæœ¬ç®¡ç†ã€‚
- nvm list [available]ï¼šæŸ¥çœ‹å·²å®‰è£…çš„nodeç‰ˆæœ¬ã€‚availableå¯é€‰å‚æ•°ï¼ŒæŸ¥çœ‹æ‰€æœ‰å¯å®‰è£…çš„nodeç‰ˆæœ¬ã€‚listå¯ç®€åŒ–æˆlsã€‚
- nvm install [version]ï¼šå®‰è£…æŒ‡å®šçš„nodeç‰ˆæœ¬ã€‚
- nvm use [version] [arch]ï¼šä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„nodeã€‚å¯æŒ‡å®š32ä½æˆ–64ä½ã€‚
- nvm uninstall \<version>: å¸è½½æŒ‡å®šç‰ˆæœ¬çš„nodeã€‚
* nvm versionï¼šæŸ¥çœ‹nvmç‰ˆæœ¬å·ã€‚versionå¯ç®€åŒ–ä¸ºvã€‚
* nvm proxy url  è®¾ç½®ä»£ç†åœ°å€



### é‡åˆ°çš„é—®é¢˜??? (å¾…è§£å†³)

åœ¨ç®¡ç†å‘˜æƒé™ä¸‹ä½¿ç”¨cmdçª—å£å‘½ä»¤, åªæœ‰ä½¿ç”¨å…¨å±€å®‰è£…`-g`æ‰èƒ½å°†ä¸‹è½½çš„åŒ…å®‰è£…åˆ°nvmè®¾ç½®çš„ç›®å½•ä¸­.å¦åˆ™å°†å®‰è£…åœ¨å½“å‰å‘½ä»¤è¡Œä½ç½®ä¸‹çš„ç›®å½•.



#### å®‰è£…yarnå,æ— æ³•è¯†åˆ«

**å…¨å±€å®‰è£…yarn**

```bash
npm install yarn -g
```

**æ£€æŸ¥**
æ£€æŸ¥ä½†æ— æ³•è¯†åˆ«å‘½ä»¤, åœ¨å½“å‰nodeç‰ˆæœ¬æ–‡ä»¶å¤¹ä¸‹ä¹Ÿæ²¡æœ‰å‘ç°yarn.
```bash
yarn -v
```

**è§£å†³**

éœ€è¦è¿›è¡Œç¯å¢ƒå˜é‡çš„é…ç½®ï¼ˆå°±æ˜¯æŠŠyarn.cmdå‘½ä»¤é…ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­). ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤éƒ½åœ¨ç›¸åº”çš„binç›®å½•ä¸‹ï¼Œä½†è¿™é‡Œæ¯”è¾ƒç‰¹æ®Šï¼Œç³»ç»Ÿè‡ªåŠ¨ä¿å­˜åœ¨äº†node_globalç›®å½•ä¸‹.

é‡å¯cmdçª—å£,é‡æ–°æ£€æŸ¥yarnç‰ˆæœ¬



#### å‘½ä»¤è¡Œå®‰è£…å,cmdä¸­æ— æ³•è¿è¡Œnvm

æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°èƒ½è§£å†³çš„æ–¹æ³•



### npxä»‹ç»
> https://github.com/LightXJ/blog/issues/28

#### æ˜¯ä»€ä¹ˆ
npmä»5.2ç‰ˆå¼€å§‹ï¼Œå¢åŠ äº†npxå‘½ä»¤ã€‚å®ƒæœ‰å¾ˆå¤šç”¨å¤„ï¼Œæœ¬æ–‡ä»‹ç»è¯¥å‘½ä»¤ä¸»è¦ä½¿ç”¨åœºæ™¯ã€‚  
Nodeè‡ªå¸¦npmæ¨¡å—ï¼Œnpxåˆæ˜¯npmçš„è‡ªå¸¦æ¨¡å—ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨npxå‘½ä»¤ã€‚ä¸‡ä¸€ä¸èƒ½ï¼Œå¯ä»¥æ‰‹åŠ¨å®‰è£…ä¸º  
`npm install -g npx`

#### ä½œç”¨
**è°ƒç”¨é¡¹ç›®å®‰è£…çš„æ¨¡å—**
npxæƒ³è¦è§£å†³çš„ä¸»è¦é—®é¢˜ï¼Œå°±æ˜¯è°ƒç”¨é¡¹ç›®å†…éƒ¨å®‰è£…çš„æ¨¡å—ã€‚æ¯”å¦‚ï¼Œé¡¹ç›®å†…éƒ¨å®‰è£…äº†æµ‹è¯•å·¥å…·Mocha  
`npm install -d mocha`  
ä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨Mocha,åªèƒ½åœ¨é¡¹ç›®è„šæœ¬å’Œpackage.jsonçš„scriptså­—æ®µé‡Œé¢ï¼Œå¦‚æœæƒ³åœ¨å‘½ä»¤è¡Œä¸‹è°ƒç”¨ï¼Œå¿…é¡»åƒä¸‹é¢

```js
# é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œ
$ node-modules/.bin/mocha --version
```

npxå°±æ˜¯æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®©é¡¹ç›®å†…éƒ¨å®‰è£…çš„æ¨¡å—ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼Œåªè¦åƒä¸‹é¢è¿™æ ·è°ƒç”¨å°±è¡Œäº†ã€‚

```js
npx mocha --version
```

**é¿å…å…¨å±€å®‰è£…**
é™¤äº†è°ƒç”¨é¡¹ç›®å†…éƒ¨æ¨¡å—ï¼Œnpxè¿˜èƒ½é¿å…å…¨å±€å®‰è£…çš„æ¨¡å—ã€‚æ¯”å¦‚ï¼Œcreate-react-appè¿™ä¸ªæ¨¡å—æ˜¯å…¨å±€å®‰è£…ï¼Œnpxå¯ä»¥è¿è¡Œå®ƒï¼Œè€Œä¸”ä¸è¿›è¡Œå…¨å±€å®‰è£…ã€‚  
`npx create-react-app my-react-app`  
ä¸Šé¢ä»£ç è¿è¡Œæ—¶ï¼Œnpxå°†create-react-appä¸‹è½½åˆ°ä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œä½¿ç”¨ä»¥åå†åˆ é™¤ã€‚æ‰€ä»¥ï¼Œä»¥åå†æ¬¡æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œä¼šé‡æ–°ä¸‹è½½create-react-app

ä¸‹è½½å…¨å±€æ¨¡å—æ—¶ï¼Œnpxå…è®¸æŒ‡å®šç‰ˆæœ¬  
`npx uglify-js@3.1.0 main.js -o ./dist/main.js`  
ä¸Šé¢ä»£ç æŒ‡å®šä½¿ç”¨3.1.0ç‰ˆæœ¬çš„uglify-jså‹ç¼©è„šæœ¬  
æ³¨æ„ï¼Œåªè¦npxåé¢çš„æ¨¡å—æ— æ³•åœ¨æœ¬åœ°å‘ç°ï¼Œå°±ä¼šä¸‹è½½åŒåæ¨¡å—ã€‚æ¯”å¦‚ï¼Œæœ¬åœ°æ²¡æœ‰å®‰è£…http-serveræ¨¡å—ï¼Œä¸‹é¢çš„å‘½ä»¤ä¼šè‡ªåŠ¨ä¸‹è½½è¯¥æ¨¡å—ï¼Œåœ¨å½“å‰ç›®å½•å¯åŠ¨ä¸€ä¸ªwebæœåŠ¡ã€‚  
`npx http-server`

#### é…ç½®




### package.json

#### èµ„æ–™

> è‹±æ–‡åŸç‰ˆï¼šhttps://docs.npmjs.com/files/package.json
>
> å›½å†…æ•´ç†ï¼šã€Š[npmçš„package.jsonä¸­æ–‡æ–‡æ¡£](https://github.com/ericdum/mujiang.info/issues/6/)ã€‹



#### æ˜¯ä»€ä¹ˆ

å¤§å®¶éƒ½çŸ¥é“ï¼Œ**`package.json ç”¨æ¥æè¿°é¡¹ç›®åŠé¡¹ç›®æ‰€ä¾èµ–çš„æ¨¡å—ä¿¡æ¯ã€‚`**ï¼Œå°±æ˜¯å¸®æˆ‘ä»¬ç®¡ç†é¡¹ç›®ä¸­çš„ä¾èµ–åŒ…çš„ï¼Œè®©æˆ‘ä»¬è¿œç¦»äº†ä¾èµ–åœ°ç‹±ã€‚

package.jsonæ˜¯ç®¡ç†å…¶ä¾èµ–çš„é…ç½®æ–‡ä»¶, åˆå§‹åŒ–é¡¹ç›®æ—¶, ä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆ3ä¸ªç›®å½•/æ–‡ä»¶:

* node_modules
* package.json
* package.lock.json



#### package-lcok.json

æœ¬è´¨ä¸Špackage-lock.jsonæ–‡ä»¶æ˜¯ä¸ºäº†é”ç‰ˆæœ¬, åœ¨package.jsonä¸­æŒ‡å®šçš„å­npmåŒ…æ¯”å¦‚ï¼šreact: "^16.0.0"ï¼Œåœ¨å®é™…å®‰è£…ä¸­ï¼Œåªè¦é«˜äºreactçš„ç‰ˆæœ¬éƒ½æ»¡è¶³package.jsonçš„è¦æ±‚ã€‚è¿™æ ·å°±ä½¿å¾—æ ¹æ®åŒä¸€ä¸ªpackage.jsonæ–‡ä»¶ï¼Œä¸¤æ¬¡å®‰è£…çš„å­ä¾èµ–ç‰ˆæœ¬ä¸èƒ½ä¿è¯ä¸€è‡´ã€‚





#### package.json å¸¸ç”¨å±æ€§

ä»¥ä¸‹æŒ‡ç¤ºé€‰å–äº†å…¶ä¸­å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å­—æ®µ:

**name**

åœ¨package.jsonä¸­æœ€é‡è¦çš„å°±æ˜¯nameå’Œversionå­—æ®µã€‚ä»–ä»¬éƒ½æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœæ²¡æœ‰å°±æ— æ³•installã€‚nameå’Œversionä¸€èµ·ç»„æˆçš„æ ‡è¯†åœ¨å‡è®¾ä¸­æ˜¯å”¯ä¸€çš„ã€‚æ”¹å˜åŒ…åº”è¯¥åŒæ—¶æ”¹å˜versionã€‚

nameæ˜¯è¿™ä¸ªä¸œè¥¿çš„åå­—ã€‚æ³¨æ„ï¼š

- ä¸è¦æŠŠnodeæˆ–è€…jsæ”¾åœ¨åå­—ä¸­ã€‚å› ä¸ºä½ å†™äº†package.jsonå®ƒå°±è¢«å‡å®šæˆä¸ºäº†jsï¼Œä¸è¿‡ä½ å¯ä»¥ç”¨"engine"å­—æ®µæŒ‡å®šä¸€ä¸ªå¼•æ“ï¼ˆè§åæ–‡ï¼‰ã€‚
- è¿™ä¸ªåå­—ä¼šä½œä¸ºåœ¨URLçš„ä¸€éƒ¨åˆ†ã€å‘½ä»¤è¡Œçš„å‚æ•°æˆ–è€…æ–‡ä»¶å¤¹çš„åå­—ã€‚ä»»ä½•non-url-safeçš„å­—ç¬¦éƒ½æ˜¯ä¸èƒ½ç”¨çš„ã€‚
- è¿™ä¸ªåå­—å¯èƒ½ä¼šä½œä¸ºå‚æ•°è¢«ä¼ å…¥require()ï¼Œæ‰€ä»¥å®ƒåº”è¯¥æ¯”è¾ƒçŸ­ï¼Œä½†ä¹Ÿè¦æ„ä¹‰æ¸…æ™°ã€‚
- åœ¨ä½ çˆ±ä¸Šä½ çš„åå­—ä¹‹å‰ï¼Œä½ å¯èƒ½è¦å»npm registryæŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåå­—æ˜¯å¦å·²ç»è¢«ä½¿ç”¨äº†ã€‚http://registry.npmjs.org/

**version**

versionå¿…é¡»èƒ½è¢«[node-semver](https://github.com/isaacs/node-semver)è§£æï¼Œå®ƒè¢«åŒ…åœ¨npmçš„ä¾èµ–ä¸­ã€‚ï¼ˆè¦è‡ªå·±ç”¨å¯ä»¥æ‰§è¡Œ`npm install semver`ï¼‰

**scripts**

åœ¨npmä¸­ä½¿ç”¨scriptæ ‡ç­¾æ¥å®šä¹‰è„šæœ¬ï¼Œæ¯å½“åˆ¶å®šnpm runçš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªshellè„šæœ¬ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œnpm runæ–°å»ºçš„è¿™ä¸ª Shellï¼Œä¼šå°†æœ¬åœ°ç›®å½•çš„node_modules/.binå­ç›®å½•åŠ å…¥PATHå˜é‡ã€‚

è¿™æ„å‘³ç€ï¼Œå½“å‰ç›®å½•çš„node_modules/.binå­ç›®å½•é‡Œé¢çš„æ‰€æœ‰è„šæœ¬ï¼Œéƒ½å¯ä»¥ç›´æ¥ç”¨è„šæœ¬åè°ƒç”¨ï¼Œè€Œä¸å¿…åŠ ä¸Šè·¯å¾„ã€‚æ¯”å¦‚ï¼Œå½“å‰é¡¹ç›®çš„ä¾èµ–é‡Œé¢æœ‰ esbuildï¼Œåªè¦ç›´æ¥å†™esbuild xxx å°±å¯ä»¥äº†ã€‚

ä»¥ä¸‹ä¸¤ç§å†™æ³•éƒ½æ˜¯ç­‰ä»·çš„:

```json
{
//...  

"script" : {
  "build": "esbuild index.js"
}

}
```



```json
{
  //...
  "script": {
    "build": "./node_modules/.bin/esbuild index.js"
  }
}
```

<span style="color:blue">æ³¨æ„äº‹é¡¹:</span>
å¦‚æœæˆ‘åœ¨é¡¹ç›®ä¸‹åªæ˜¯å®‰è£…ä¸€ä¸ªå±€éƒ¨åŒ…,é‚£ä¹ˆæˆ‘è¿è¡Œè¿™ä¸ªåŒ…å‘½ä»¤çš„è¯,ä¼šæ˜¾ç¤ºnpmæ— æ³•è¯†åˆ«è¿™ä¸ªå‘½ä»¤.(å¾…ä¸Šä¼ ä¸€ä¸ªå®ä¾‹å›¾ç‰‡...)
åŸå› ? [[#å¸ƒå±€å®‰è£…çš„åŒ…çš„å‘½ä»¤æ— æ³•åˆ«è¯†åˆ«]]




**bin**

binå±æ€§ç”¨æ¥å°†å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å…¨å±€ç¯å¢ƒä¸­ï¼ŒæŒ‡å®šäº†binå­—æ®µçš„npmåŒ…ï¼Œä¸€æ—¦åœ¨å…¨å±€å®‰è£…ï¼Œå°±ä¼šè¢«åŠ è½½åˆ°å…¨å±€ç¯å¢ƒä¸­ï¼Œå¯ä»¥é€šè¿‡åˆ«åæ¥æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚

æ¯”å¦‚\@bytepack/cliçš„npmåŒ…ï¼š

```json
"bin": {
    "bytepack": "./bin/index.js"
 },
```

ä¸€æ—¦åœ¨å…¨å±€å®‰è£…äº†@bytepack/cliï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡bytepackæ¥æ‰§è¡Œç›¸åº”çš„å‘½ä»¤ï¼Œæ¯”å¦‚

```bash
bytepack -v
// æ˜¾ç¤º1.11.0
```

å¦‚æœéå…¨å±€å®‰è£…ï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨è¿æ¥åˆ°é¡¹ç›®çš„node_module/.binç›®å½•ä¸­ã€‚ä¸å‰é¢ä»‹ç»çš„scriptæ ‡ç­¾ä¸­æ‰€è¯´çš„ä¸€è‡´ï¼Œå¯ä»¥ç›´æ¥ç”¨åˆ«åæ¥ä½¿ç”¨ã€‚





**workspaces**  ???

workspacesè§£å†³äº†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­å¦‚ä½•åœ¨ä¸€ä¸ªé¡¶å±‚root packageä¸‹ç®¡ç†å¤šä¸ªå­packagesçš„é—®é¢˜ï¼Œåœ¨workspaceså£°æ˜ç›®å½•ä¸‹çš„packageä¼šè½¯é“¾åˆ°æœ€ä¸Šå±‚root packageçš„node_modulesä¸­





#### package.jsonç¯å¢ƒç›¸å…³å±æ€§

å¸¸è§çš„ç¯å¢ƒï¼ŒåŸºæœ¬ä¸Šåˆ†ä¸ºæµè§ˆå™¨browserå’Œnodeç¯å¢ƒä¸¤å¤§ç±»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹package.jsonä¸­ï¼Œè·Ÿç¯å¢ƒç›¸å…³çš„é…ç½®å±æ€§ã€‚ç¯å¢ƒçš„å®šä¹‰å¯ä»¥ç®€å•ç†è§£å¦‚ä¸‹ï¼š

- browserç¯å¢ƒï¼šæ¯”å¦‚å­˜åœ¨ä¸€äº›åªæœ‰åœ¨æµè§ˆå™¨ä¸­æ‰ä¼šå­˜åœ¨çš„å…¨å±€å˜é‡ç­‰ï¼Œæ¯”å¦‚windowï¼ŒDocumentç­‰
- nodeç¯å¢ƒ: npmåŒ…çš„æºæ–‡ä»¶ä¸­å­˜åœ¨åªæœ‰åœ¨nodeç¯å¢ƒä¸­æ‰ä¼šæœ‰çš„ä¸€äº›å˜é‡å’Œå†…ç½®åŒ…ï¼Œå†…ç½®å‡½æ•°ç­‰ã€‚



**type**

jsçš„æ¨¡å—åŒ–è§„èŒƒåŒ…å«äº†commonjsã€CMDã€UMDã€AMDå’ŒES moduleç­‰, ä»node13.2.0å¼€å§‹åï¼Œnodeæ­£å¼æ”¯æŒäº†ES moduleè§„èŒƒï¼Œåœ¨package.jsonä¸­å¯ä»¥é€šè¿‡typeå­—æ®µæ¥å£°æ˜npmåŒ…éµå¾ªçš„æ¨¡å—åŒ–è§„èŒƒã€‚

package.json

```json
{
   name: "some package",
   type: "module"||"commonjs" 
}
```

- ä¸æŒ‡å®štypeçš„æ—¶å€™ï¼Œtypeçš„é»˜è®¤å€¼æ˜¯commonjsï¼Œä¸è¿‡å»ºè®®npmåŒ…éƒ½æŒ‡å®šä¸€ä¸‹type
- å½“typeå­—æ®µæŒ‡å®šå€¼ä¸ºmoduleåˆ™é‡‡ç”¨ESModuleè§„èŒƒ
- å½“typeå­—æ®µæŒ‡å®šæ—¶ï¼Œç›®å½•ä¸‹çš„æ‰€æœ‰.jsåç¼€ç»“å°¾çš„æ–‡ä»¶ï¼Œéƒ½éµå¾ªtypeæ‰€æŒ‡å®šçš„æ¨¡å—åŒ–è§„èŒƒ
- é™¤äº†typeå¯ä»¥æŒ‡å®šæ¨¡å—åŒ–è§„èŒƒå¤–ï¼Œé€šè¿‡æ–‡ä»¶çš„åç¼€æ¥æŒ‡å®šæ–‡ä»¶æ‰€éµå¾ªçš„æ¨¡å—åŒ–è§„èŒƒï¼Œä»¥.mjsç»“å°¾çš„æ–‡ä»¶å°±æ˜¯ä½¿ç”¨çš„ESModuleè§„èŒƒï¼Œä»¥.cjsç»“å°¾çš„éµå¾ªçš„æ˜¯commonjsè§„èŒƒ



**main /  modules  /browser**

- main : å®šä¹‰äº† npm åŒ…çš„å…¥å£æ–‡ä»¶ï¼Œbrowser ç¯å¢ƒå’Œ node ç¯å¢ƒå‡å¯ä½¿ç”¨
- module : å®šä¹‰ npm åŒ…çš„ ESM è§„èŒƒçš„å…¥å£æ–‡ä»¶ï¼Œbrowser ç¯å¢ƒå’Œ node - ç¯å¢ƒå‡å¯ä½¿ç”¨
- browser : å®šä¹‰ npm åŒ…åœ¨ browser ç¯å¢ƒä¸‹çš„å…¥å£æ–‡ä»¶

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™3ä¸ªå­—æ®µçš„ä½¿ç”¨åœºæ™¯ï¼Œä»¥åŠåŒæ—¶å­˜åœ¨è¿™3ä¸ªå­—æ®µæ—¶çš„ä¼˜å…ˆçº§ã€‚æˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸ªnpmåŒ…ä¸ºdemo1,

```bash
----- dist
   |-- index.browser.js
   |-- index.browser.mjs
   |-- index.js
   |-- index.mjs
```



å…¶package.jsonä¸­åŒæ—¶æŒ‡å®šäº†main,moduleå’Œbrowserè¿™3ä¸ªå­—æ®µï¼Œ

```json
  "main": "dist/index.js",  // main 
  "module": "dist/index.mjs", // module

  // browser å¯å®šä¹‰æˆå’Œ main/module å­—æ®µä¸€ä¸€å¯¹åº”çš„æ˜ å°„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰ä¸ºå­—ç¬¦ä¸²
  "browser": {
    "./dist/index.js": "./dist/index.browser.js", // browser+cjs
    "./dist/index.mjs": "./dist/index.browser.mjs"  // browser+mjs
  },

  // "browser": "./dist/index.browser.js" // browser
```

é»˜è®¤æ„å»ºå’Œä½¿ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¼•ç”¨è¿™ä¸ªnpmåŒ…ï¼š

é€šè¿‡æ„å»ºå·¥å…·æ„å»ºä¸Šè¿°ä»£ç åï¼Œæ¨¡å—çš„åŠ è½½å¾ªåºä¸ºï¼š_**browser+mjs > module > browser+cjs > main**_è¿™ä¸ªåŠ è½½é¡ºåºæ˜¯å¤§éƒ¨åˆ†æ„å»ºå·¥å…·é»˜è®¤çš„åŠ è½½é¡ºåºï¼Œæ¯”å¦‚webapckã€esbuildç­‰ç­‰ã€‚å¯ä»¥é€šè¿‡ç›¸åº”çš„é…ç½®ä¿®æ”¹è¿™ä¸ªåŠ è½½é¡ºåºï¼Œä¸è¿‡å¤§éƒ¨åˆ†åœºæ™¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šéµå¾ªé»˜è®¤çš„åŠ è½½é¡ºåºã€‚



**exports**

å¦‚æœåœ¨package.jsonä¸­å®šä¹‰äº†exportså­—æ®µï¼Œé‚£ä¹ˆè¿™ä¸ªå­—æ®µæ‰€å®šä¹‰çš„å†…å®¹å°±æ˜¯è¯¥npmåŒ…çš„çœŸå®å’Œå…¨éƒ¨çš„å¯¼å‡ºï¼Œä¼˜å…ˆçº§ä¼šé«˜äºmainå’Œfileç­‰å­—æ®µã€‚

```json
{
  "name": "pkg",
  "exports": {
    ".": "./main.mjs",
    "./foo": "./foo.js"
  }
}
```



```javascript
import { something } from "pkg"; // from "pkg/main.mjs"
```



```javascript
const { something } = require("pkg/foo"); // require("pkg/foo.js")
```

ä»ä¸Šè¿°çš„ä¾‹å­æ¥çœ‹ï¼Œexportså¯ä»¥å®šä¹‰ä¸åŒpathçš„å¯¼å‡ºã€‚å¦‚æœå­˜åœ¨exportsåï¼Œä»¥å‰æ­£å¸¸ç”Ÿæ•ˆçš„fileç›®å½•åˆ°å¤„ä¼šå¤±æ•ˆï¼Œæ¯”å¦‚require('pkg/package.json')ï¼Œå› ä¸ºåœ¨exportsä¸­æ²¡æœ‰æŒ‡å®šï¼Œå°±ä¼šæŠ¥é”™ã€‚  exportsè¿˜æœ‰ä¸€ä¸ªæœ€å¤§çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯æ¡ä»¶å¼•ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„å¼•ç”¨æ–¹å¼æˆ–è€…æ¨¡å—åŒ–ç±»å‹ï¼Œæ¥æŒ‡å®šnpmåŒ…å¼•ç”¨ä¸åŒçš„å…¥å£æ–‡ä»¶ã€‚

```json
// package.json
{ 
  "name":"pkg",
  "main": "./main-require.cjs",
  "exports": {
    "import": "./main-module.js",
    "require": "./main-require.cjs"
  },
  "type": "module"
}
```

ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œå¦‚æœæˆ‘ä»¬é€šè¿‡

```
const p = require('pkg')
```

å¼•ç”¨çš„å°±æ˜¯"./main-require.cjs"ã€‚å¦‚æœé€šè¿‡ï¼š

```
import p from 'pkg'
```

å¼•ç”¨çš„å°±æ˜¯"./main-module.js"æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ ï¼š***å¦‚æœå­˜åœ¨exportså±æ€§ï¼Œexportså±æ€§ä¸ä»…ä¼˜å…ˆçº§é«˜äºmainï¼ŒåŒæ—¶ä¹Ÿé«˜äºmoduleå’Œbrowserå­—æ®µã€‚***





#### package.jsonä¾èµ–ç›¸å…³å±æ€§

package.jsonä¸­è·Ÿä¾èµ–ç›¸å…³çš„é…ç½®å±æ€§åŒ…å«äº†dependenciesã€devDependenciesã€peerDependencieså’ŒpeerDependenciesMetaç­‰ã€‚

dependenciesæ˜¯é¡¹ç›®çš„ä¾èµ–ï¼Œè€ŒdevDependenciesæ˜¯å¼€å‘æ‰€éœ€è¦çš„æ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦çš„å®‰è£…ä¸Šå»ï¼Œæ¥æé«˜æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ—¶ï¼Œåœ¨è‡ªå·±çš„é¡¹ç›®ä¸­å°½é‡çš„è§„èŒƒä½¿ç”¨ï¼Œå½¢å¦‚webpackã€babelç­‰æ˜¯å¼€å‘ä¾èµ–ï¼Œè€Œä¸æ˜¯é¡¹ç›®æœ¬èº«çš„ä¾èµ–ï¼Œä¸è¦æ”¾åœ¨dependenciesä¸­ã€‚



**dependencies**

ä¾èµ–æ˜¯ç»™ä¸€ç»„åŒ…åæŒ‡å®šç‰ˆæœ¬èŒƒå›´çš„ä¸€ä¸ªhashã€‚è¿™ä¸ªç‰ˆæœ¬èŒƒå›´æ˜¯ä¸€ä¸ªç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åˆ†éš”çš„å­—ç¬¦ä¸²ã€‚ä¾èµ–è¿˜å¯ä»¥ç”¨tarballæˆ–è€…git URLã€‚

è¯·ä¸è¦å°†æµ‹è¯•æˆ–è¿‡æ¸¡æ€§çš„ä¾èµ–æ”¾åœ¨`dependencies`hashä¸­

**devDependencies**

å¦‚æœæœ‰äººè¦ä½¿ç”¨ä½ çš„æ¨¡å—ï¼Œé‚£ä¹ˆä»–ä»¬å¯èƒ½ä¸éœ€è¦ä½ å¼€å‘ä½¿ç”¨çš„å¤–éƒ¨æµ‹è¯•æˆ–è€…æ–‡æ¡£æ¡†æ¶ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½å°†è¿™äº›é™„å±çš„é¡¹ç›®åˆ—åœ¨`devDependencies`ä¸­ã€‚

è¿™äº›ä¸œè¥¿ä¼šåœ¨æ‰§è¡Œ`npm link`æˆ–è€…`npm install`çš„æ—¶å€™åˆå§‹åŒ–ï¼Œå¹¶å¯ä»¥åƒå…¶ä»–npmé…ç½®å‚æ•°ä¸€æ ·ç®¡ç†ã€‚



**peerDependencies**

peerDependenciesæ˜¯package.jsonä¸­çš„ä¾èµ–é¡¹,å¯ä»¥è§£å†³æ ¸å¿ƒåº“è¢«ä¸‹è½½å¤šæ¬¡ï¼Œä»¥åŠç»Ÿä¸€æ ¸å¿ƒåº“ç‰ˆæœ¬çš„é—®é¢˜ã€‚

```json
//package/pkg
----- node_modules
   |-- npm-a -> ä¾èµ–äº†react,react-dom
   |-- npm-b -> ä¾èµ–äº†react,react-dom
   |-- index.js
```

æ¯”å¦‚ä¸Šè¿°çš„ä¾‹å­ä¸­å¦‚æœå­npmåŒ…a,béƒ½ä»¥æ¥äº†reactå’Œreact-dom,æ­¤æ—¶å¦‚æœæˆ‘ä»¬åœ¨å­npmåŒ…a,bçš„package.jsonä¸­å£°æ˜äº†PeerDependiciesåï¼Œç›¸åº”çš„ä¾èµ–å°±ä¸ä¼šé‡æ–°å®‰è£…ã€‚éœ€è¦æ³¨æ„çš„æœ‰ä¸¤ç‚¹ï¼š









**peerDependenciesMeta**

çœ‹åˆ°â€œMetaâ€å°±æœ‰å…ƒæ•°æ®çš„æ„æ€ï¼Œè¿™é‡Œçš„peerDependenciesMetaå°±æ˜¯è¯¦ç»†ä¿®é¥°äº†peerDependiciesï¼Œæ¯”å¦‚åœ¨react-reduxè¿™ä¸ªnpmåŒ…ä¸­çš„package.jsonä¸­æœ‰è¿™ä¹ˆä¸€æ®µï¼š

```json
 "peerDependencies": {
    "react": "^16.8.3 || ^17 || ^18"
  },
 "peerDependenciesMeta": {
    "react-dom": {
      "optional": true
    },
    "react-native": {
      "optional": true
    }
  }
```

è¿™é‡ŒæŒ‡å®šäº†"react-dom","react-native"åœ¨peerDependenciesMetaä¸­ï¼Œä¸”ä¸ºå¯é€‰é¡¹ï¼Œå› æ­¤å¦‚æœé¡¹ç›®ä¸­æ£€æµ‹æ²¡æœ‰å®‰è£…"react-dom"å’Œ"react-native"éƒ½ä¸ä¼šæŠ¥é”™ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡peerDependenciesMetaæˆ‘ä»¬ç¡®å®æ˜¯å–æ¶ˆäº†é™åˆ¶ï¼Œä½†æ˜¯è¿™é‡Œç»å¸¸å­˜åœ¨éAå³Bçš„åœºæ™¯ï¼Œæ¯”å¦‚ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯â€œreact-domâ€å’Œ"react-native"éœ€è¦å®‰è£…ä¸€ä¸ªï¼Œä½†æ˜¯å®é™…ä¸Šé€šè¿‡ä¸Šè¿°çš„å£°æ˜ï¼Œæˆ‘ä»¬å®ç°ä¸äº†è¿™ç§æç¤ºã€‚







#### ç‰ˆæœ¬å·

> å…¬ä¼—å·: ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—

ç‰ˆæœ¬å·ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š`major.minor.patch`ï¼Œä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è¡¥ç‰ˆæœ¬å·ã€‚

ä¾‹å¦‚ï¼š1.2.3ï¼Œä¸»è¦ç‰ˆæœ¬1ï¼Œæ¬¡è¦ç‰ˆæœ¬2ï¼Œè¡¥ä¸3ã€‚

- `è¡¥ä¸`ä¸­çš„æ›´æ”¹è¡¨ç¤ºä¸ä¼šç ´åä»»ä½•å†…å®¹çš„é”™è¯¯ä¿®å¤ã€‚
- `æ¬¡è¦ç‰ˆæœ¬`çš„æ›´æ”¹è¡¨ç¤ºä¸ä¼šç ´åä»»ä½•å†…å®¹çš„æ–°åŠŸèƒ½ã€‚
- `ä¸»è¦ç‰ˆæœ¬`çš„æ›´æ”¹ä»£è¡¨äº†ä¸€ä¸ªç ´åå…¼å®¹æ€§çš„å¤§å˜åŒ–ã€‚å¦‚æœç”¨æˆ·ä¸é€‚åº”ä¸»è¦ç‰ˆæœ¬æ›´æ”¹ï¼Œåˆ™å†…å®¹å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚

#### å®‰è£…ä¾èµ–åŒ…çš„ç‰ˆæœ¬å¦‚ä½•æŒ‡å®š

`~` ä¼šåŒ¹é…æœ€è¿‘çš„å°ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œæ¯”å¦‚ ~1.2.3 ä¼šåŒ¹é…æ‰€æœ‰ 1.2.x ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ 1.3.0

`^` ä¼šåŒ¹é…æœ€æ–°çš„å¤§ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œæ¯”å¦‚ ^1.2.3 ä¼šåŒ¹é…æ‰€æœ‰ 1.x.x çš„åŒ…ï¼ŒåŒ…æ‹¬ 1.3.0ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ 2.0.0

`*` å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ä¾èµ–åŒ…ï¼Œæ¯”å¦‚ *1.2.3 ä¼šåŒ¹é… x.x.xï¼Œ



ä½ å¯ä»¥`æŒ‡å®šç‰¹å®šçš„ç‰ˆæœ¬å·`ï¼Œç›´æ¥å†™1.2.3ï¼Œå‰é¢**ä»€ä¹ˆå‰ç¼€éƒ½æ²¡æœ‰**ï¼Œè¿™æ ·å›ºç„¶æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœä¾èµ–åŒ…å‘å¸ƒæ–°ç‰ˆæœ¬ä¿®å¤äº†ä¸€äº›å°bugï¼Œé‚£ä¹ˆéœ€è¦æ‰‹åŠ¨ä¿®æ”¹package.jsonæ–‡ä»¶ï¼›`~` å’Œ `^` åˆ™å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

ä½†æ˜¯éœ€è¦æ³¨æ„ ^ ç‰ˆæœ¬æ›´æ–°å¯èƒ½æ¯”è¾ƒå¤§ï¼Œä¼šé€ æˆé¡¹ç›®ä»£ç é”™è¯¯ï¼Œ **å»ºè®®ä½¿ç”¨ `~` æ¥æ ‡è®°ç‰ˆæœ¬å·**ï¼Œè¿™æ ·å¯ä»¥ä¿è¯é¡¹ç›®ä¸ä¼šå‡ºç°å¤§çš„é—®é¢˜ï¼Œä¹Ÿèƒ½ä¿è¯åŒ…ä¸­çš„å°bugå¯ä»¥å¾—åˆ°ä¿®å¤ã€‚

ç‰ˆæœ¬å·å†™ *ï¼Œè¿™æ„å‘³ç€å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ä¾èµ–åŒ…ï¼Œä½†ç¼ºç‚¹åŒä¸Šï¼Œå¯èƒ½ä¼šé€ æˆç‰ˆæœ¬ä¸å…¼å®¹ï¼Œ**æ…ç”¨ï¼**



#### å¤šäººå¼€å‘æ—¶ä¾èµ–åŒ…å®‰è£…çš„é—®é¢˜

åœºæ™¯ä»‹ç»:

å‡è®¾æˆ‘ä»¬ä¸­å®‰è£…äº† `vue`, å½“æˆ‘ä»¬è¿è¡Œå®‰è£… `npm install vue -save` çš„æ—¶å€™ï¼Œåœ¨é¡¹ç›®ä¸­çš„package.json çš„ vue ç‰ˆæœ¬æ˜¯  `vue: ^3.0.0`,ï¼Œvue å‘å¸ƒäº†æ–°ç‰ˆæœ¬ 3.0.1ï¼Œè¿™æ—¶æ–°æ¥ä¸€ä¸ªåŒäº‹ï¼Œä»æ–° `git clone` å…‹éš†é¡¹ç›®ï¼Œæ‰§è¡Œ `npm install`å®‰è£…çš„æ—¶å€™ï¼Œåœ¨ä»–ç”µè„‘çš„vueç‰ˆæœ¬å°±æ˜¯ 3.0.1äº†ï¼Œå› ä¸º^åªæ˜¯é”äº†ä¸»è¦ç‰ˆæœ¬ï¼Œè¿™æ ·æˆ‘ä»¬ç”µè„‘ä¸­çš„vueç‰ˆæœ¬å°±ä¼šä¸ä¸€æ ·.

**ä»ç†è®ºä¸Šè®²ï¼ˆå¤§å®¶éƒ½éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶çš„è¯ï¼‰**ï¼Œå®ƒä»¬åº”è¯¥ä»ç„¶æ˜¯å…¼å®¹çš„ï¼Œä½†ä¹Ÿè®¸ bugfix ä¼šå½±å“æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„åŠŸèƒ½ï¼Œè€Œä¸”å½“ä½¿ç”¨vueç‰ˆæœ¬3.0.0å’Œ3.0.1è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¼šäº§ç”Ÿä¸åŒçš„ç»“æœã€‚



è§£å†³æ–¹æ³•:

ä¸ºäº†è§£å†³è¿™ä¸ªä¸åŒäººç”µè„‘å®‰è£…çš„æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬éƒ½æ˜¯ä¸€è‡´çš„ï¼Œç¡®ä¿é¡¹ç›®ä»£ç åœ¨å®‰è£…æ‰€æ‰§è¡Œçš„è¿è¡Œç»“æœéƒ½ä¸€æ ·ï¼Œè¿™æ—¶ `package-lock.json` å°±åº”è¿è€Œç”Ÿäº†ã€‚





### package-lock.json

#### ä»‹ç»

`package-lock.json` å®ƒä¼š**åœ¨ npm æ›´æ”¹ node_modules ç›®å½•æ ‘ æˆ–è€… package.json æ—¶è‡ªåŠ¨ç”Ÿæˆçš„** ï¼Œå®ƒå‡†ç¡®çš„æè¿°äº†å½“å‰é¡¹ç›®npmåŒ…çš„ä¾èµ–æ ‘ï¼Œå¹¶ä¸”åœ¨éšåçš„å®‰è£…ä¸­ä¼šæ ¹æ® package-lock.json æ¥å®‰è£…ï¼Œä¿è¯æ˜¯ç›¸åŒçš„ä¸€ä¸ªä¾èµ–æ ‘ï¼Œä¸è€ƒè™‘è¿™ä¸ªè¿‡ç¨‹ä¸­æ˜¯å¦æœ‰æŸä¸ªä¾èµ–æœ‰å°ç‰ˆæœ¬çš„æ›´æ–°ã€‚

å®ƒçš„äº§ç”Ÿå°±æ˜¯æ¥å¯¹æ•´ä¸ªä¾èµ–æ ‘è¿›è¡Œç‰ˆæœ¬å›ºå®šçš„ï¼ˆé”æ­»ï¼‰ã€‚



å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­`npm install`æ—¶å€™ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª`package-lock.json`æ–‡ä»¶ï¼Œå’Œ`package.json`åœ¨åŒä¸€çº§ç›®å½•ä¸‹ã€‚`package-lock.json`è®°å½•äº†é¡¹ç›®çš„ä¸€äº›ä¿¡æ¯å’Œæ‰€ä¾èµ–çš„æ¨¡å—ã€‚

å½“æˆ‘ä»¬ä¸‹æ¬¡å†`npm install`æ—¶å€™ï¼Œnpm å‘ç°å¦‚æœé¡¹ç›®ä¸­æœ‰ `package-lock.json` æ–‡ä»¶ï¼Œä¼šæ ¹æ® `package-lock.json` é‡Œçš„å†…å®¹æ¥å¤„ç†å’Œå®‰è£…ä¾èµ–è€Œä¸å†æ ¹æ® `package.json`ã€‚



æ³¨æ„:

> æ³¨æ„ï¼Œä½¿ç”¨`cnpm install`æ—¶å€™ï¼Œå¹¶ä¸ä¼šç”Ÿæˆ `package-lock.json` æ–‡ä»¶ï¼Œä¹Ÿä¸ä¼šæ ¹æ® `package-lock.json` æ¥å®‰è£…ä¾èµ–åŒ…ï¼Œè¿˜æ˜¯ä¼šä½¿ç”¨ `package.json` æ¥å®‰è£…ã€‚



#### ç”Ÿæˆé€»è¾‘

å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸‰ä¸ª packageï¼Œåœ¨é¡¹ç›® lock-testä¸­ï¼Œå®‰è£…ä¾èµ–Aï¼ŒAé¡¹ç›®é¢æœ‰Bï¼ŒBé¡¹ç›®é¢æœ‰C

```json
// package lock-test
{ "name": "lock-test", "dependencies": { "A": "^1.0.0" }}
// package A
{ "name": "A", "version": "1.0.0", "dependencies": { "B": "^1.0.0" }}
// package B
{ "name": "B", "version": "1.0.0", "dependencies": { "C": "^1.0.0" }}
// package C
{ "name": "C", "version": "1.0.0" }
```

åœ¨è¿™ç§æƒ…å†µä¸‹ `package-lock.json`, ä¼šç”Ÿæˆç±»ä¼¼ä¸‹é¢é“ºå¹³çš„ç»“æ„

```json
// package-lock.json
{ 
    "name": "lock-test",  
    "version": "1.0.0",  
    "dependencies": {    
        "A": { "version": "1.0.0" },
        "B": { "version": "1.0.0" },
        "C": { "version": "1.0.0" }  
    }
}
```

å¦‚æœåç»­æ— è®ºæ˜¯ç›´æ¥ä¾èµ–çš„ A å‘ç‰ˆï¼Œæˆ–è€…é—´æ¥ä¾èµ–çš„B, C å‘ç‰ˆï¼Œåªè¦æˆ‘ä»¬ä¸åŠ¨ `package.json`, `package-lock.json` éƒ½ä¸ä¼šé‡æ–°ç”Ÿæˆã€‚

A å‘å¸ƒäº†æ–°ç‰ˆæœ¬ 1.1.0ï¼Œè™½ç„¶æˆ‘ä»¬ package.json å†™çš„æ˜¯ ^1.0.0 ä½†æ˜¯å› ä¸º `package-lock.json` çš„å­˜åœ¨ï¼Œnpm i å¹¶ä¸ä¼šè‡ªåŠ¨å‡çº§ï¼Œ

æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è¿è¡Œ npm i A@1.1.0 æ¥å®ç°å‡çº§ã€‚

å› ä¸º 1.1.0 `package-lock.json` é‡Œè®°å½•çš„ A@1.0.0 æ˜¯ä¸ä¸€è‡´çš„ï¼Œå› æ­¤ä¼šæ›´æ–° `package-lock.json` é‡Œçš„ A çš„ç‰ˆæœ¬ä¸º 1.1.0ã€‚

B å‘å¸ƒäº†æ–°ç‰ˆæœ¬ 1.0.1, 1.0.2, 1.1.0, æ­¤åˆ»å¦‚æœæˆ‘ä»¬ä¸åšæ“ä½œæ˜¯ä¸ä¼šè‡ªåŠ¨å‡çº§ B çš„ç‰ˆæœ¬çš„ï¼Œä½†å¦‚æœæ­¤åˆ» A å‘å¸ƒäº† 1.1.1ï¼Œè™½ç„¶å¹¶æ²¡æœ‰å‡çº§ B çš„ä¾èµ–ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬é¡¹ç›®é‡Œå‡çº§ A@1.1.1ï¼Œæ­¤æ—¶ `package-lock.json` é‡Œä¼šæŠŠ B ç›´æ¥å‡åˆ° 1.1.0 ,å› ä¸ºæ­¤åˆ»^1.0.0çš„æœ€æ–°ç‰ˆæœ¬å°±æ˜¯ 1.1.0ã€‚

ç»è¿‡è¿™äº›æ“ä½œå é¡¹ç›® lock-test çš„ package.json å˜æˆ

```json
// package 
lock-test{ "dependencies": { "A": "^1.1.0" }}
```

å¯¹åº”çš„ `package-lock.json` æ–‡ä»¶

```json
{  
    "name": "lock-test",  
    "version": "1.0.0",
    "dependencies": {  
        "A": { "version": "1.1.0" },
        "B": { "version": "1.1.0" },
        "C": { "version": "1.0.0" }
    }
}
```

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°† B åŠ å…¥æˆ‘ä»¬ lock-test é¡¹ç›®çš„ä¾èµ–, B@^1.0.0ï¼Œpackage.jsonå¦‚ä¸‹

```json
{ "dependencies": { "A": "^1.1.0", "B": "^1.0.0" }}
```

æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªæ“ä½œåï¼Œ`package-lock.json` å¹¶æ²¡æœ‰è¢«æ”¹å˜ï¼Œå› ä¸ºç°åœ¨ `package-lock.json` é‡Œ B@1.1.0 æ»¡è¶³ ^1.0.0 çš„è¦æ±‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬å°† B çš„ç‰ˆæœ¬å›ºå®šåˆ° 2.x ç‰ˆæœ¬, `package-lock.json` å°±ä¼šå‘ç”Ÿæ”¹å˜

```json
{ "dependencies": { "A": "^1.1.0", "B": "^2.0.0" }}
```

å› ä¸ºå­˜åœ¨äº†ä¸¤ä¸ªå†²çªçš„Bç‰ˆæœ¬ï¼Œ`package-lock.json` æ–‡ä»¶ä¼šå˜æˆå¦‚ä¸‹å½¢å¼

```json
{  
    "name": "lock-test",
    "version": "1.0.0",  
    "dependencies": {    
        "A": {      
            "version": "1.1.0",      
            "dependencies": {        
                "B": { "version": "1.1.0" }      
            }    
        },    
        "B": { "version": "2.0.0" },    
        "C": { "version": "1.0.0" }  
    }
}
```

å› ä¸º B çš„ç‰ˆæœ¬å‡ºç°äº†å†²çªï¼Œnpm ä½¿ç”¨åµŒå¥—æè¿°äº†è¿™ç§è¡Œä¸º

æˆ‘ä»¬å®é™…å¼€å‘ä¸­å¹¶ä¸éœ€è¦å…³æ³¨è¿™ç§ç”Ÿæˆçš„ç®—æ³•é€»è¾‘ï¼Œæˆ‘ä»¬åªéœ€è¦äº†è§£ï¼Œ`package-lock.json` çš„ç”Ÿæˆé€»è¾‘æ˜¯ä¸ºäº†èƒ½å¤Ÿç²¾å‡†çš„åæ˜ å‡ºæˆ‘ä»¬ node_modules çš„ç»“æ„ï¼Œå¹¶ä¿è¯èƒ½å¤Ÿè¿™ç§ç»“æ„è¢«è¿˜åŸã€‚



#### package-lock.jsonæ„å¤–æ›´æ”¹çš„åŸå› 

1. package.json æ–‡ä»¶ä¿®æ”¹äº†
2. æŒªåŠ¨äº†åŒ…çš„ä½ç½®

å°†éƒ¨åˆ†åŒ…çš„ä½ç½®ä» dependencies ç§»åŠ¨åˆ° devDependencies è¿™ç§æ“ä½œï¼Œè™½ç„¶åŒ…æœªå˜ï¼Œä½†æ˜¯ä¹Ÿä¼šå½±å“ `package-lock.json`ï¼Œä¼šå°†éƒ¨åˆ†åŒ…çš„ dev å­—æ®µè®¾ç½®ä¸º true

3. registry çš„å½±å“

ç»è¿‡å®é™…ä½¿ç”¨å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬ node_modules æ–‡ä»¶å¤¹ä¸‹çš„åŒ…ä¸­ä¸‹è½½æ—¶ï¼Œå°±ç®—ç‰ˆæœ¬ä¸€æ ·ï¼Œå®‰è£…æº `registry` ä¸åŒï¼Œæ‰§è¡Œ npm i æ—¶ä¹Ÿä¼šä¿®æ”¹ package-lock.json



å¯èƒ½è¿˜å­˜åœ¨å…¶ä»–çš„åŸå› ï¼Œä½†æ˜¯ `package-lock.json` æ˜¯ä¸ä¼šæ— ç¼˜æ— æ•…è¢«æ›´æ”¹çš„ï¼Œä¸€å®šæ˜¯å› ä¸º **package.json æˆ–è€… node_modules è¢«æ›´æ”¹äº†**ï¼Œå› ä¸º æ­£å¦‚ä¸Šé¢æåˆ°çš„ package-lock.json ä¸ºäº†èƒ½å¤Ÿç²¾å‡†çš„åæ˜ å‡ºæˆ‘ä»¬ node_modules çš„ç»“æ„



#### å¼€å‘å»ºè®®

ä¸€èˆ¬æƒ…å†µä¸‹ `npm install` æ˜¯å¯ä»¥çš„ï¼Œä»–èƒ½ä¿è¯æ ¹æ® `package-lock.json` è¿˜åŸå‡ºå¼€å‘æ—¶çš„ `node_modules`ã€‚

ä½†æ˜¯ä¸ºäº†é˜²æ­¢å‡ºç°åˆšåˆšæåˆ°çš„æ„å¤–æƒ…å†µï¼Œé™¤éæ¶‰åŠåˆ°å¯¹åŒ…çš„è°ƒæ•´ï¼Œå…¶ä»–æƒ…å†µä¸‹å»ºè®®ä½¿ç”¨ `npm ci `æ¥å®‰è£…ä¾èµ–ï¼Œä¼šé¿å…å¼‚å¸¸çš„ä¿®æ”¹ `package-lock.json`ï¼Œ

æŒç»­é›†æˆå·¥å…·ä¸­æ›´æ¨èæ˜¯ç”¨ `npm ci`ï¼Œä¿è¯`æ„å»ºç¯å¢ƒçš„å‡†ç¡®æ€§`ï¼Œ**npm i å’Œ npm ci çš„åŒºåˆ«** å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ npm-ci









### ä½¿ç”¨æµç¨‹

```js
- åœ¨é¡µé¢ä¸­ç›´æ¥è°ƒç”¨åœ°å€
1.ä¸‹è½½åˆ°æœ¬åœ°
2.é¡µé¢ä¸­ä½¿ç”¨é“¾æ¥å¼•å…¥

- nodeç¯å¢ƒä¸‹å¦‚ä½•ä½¿ç”¨

//å¼•å…¥lodashåŒ…
const _=require('lodash');
console.log(_.random(1, 100));
//nodeè°ƒç”¨jsæ–‡ä»¶


- å…¶ä»–:
åŒ…æ˜¯å­˜åœ¨ä¾èµ–çš„,ä¸‹è½½ä¸€ä¸ªåŒ…,å¯èƒ½åœ¨ä¸‹è½½äº†å¤šä¸ªåŒ…
```



#### å›¢é˜Ÿå¼€å‘ä½¿ç”¨æµç¨‹

```js
# node_modulesæ–‡ä»¶å¤¹æ˜¯ä¸è¿›å…¥gitä»“åº“çš„,éœ€è¦åœ¨.gitignoreä¸­å¿½ç•¥.
# è¿œç«¯ä»“åº“ å¼ºæ¨ä¼šè¦†ç›–è¿œç«¯ä»“åº“å†…å®¹, è¯­æ³•: git push -u origin master -f

1. ä»ä»“åº“ä¸­æ‹‰å–ä»“åº“ä»£ç  //git clone è¿œç«¯åœ°å€
2. è¿è¡Œ npm install å®‰è£…ç›¸å…³ä¾èµ– //npm i
3. è¿è¡Œé¡¹ç›®ï¼Œç»§ç»­å¼€å‘


```







```js
npm -version/-v
npm init/i åˆå§‹åŒ–
npm i --yes ç®€æ´å†™æ³• å…¨éƒ¨é‡‡ç”¨é»˜è®¤å€¼,ä½†ä¸Šçº§è·¯å¾„ä¸­ä¸èƒ½å­˜åœ¨ä¸­æ–‡
npm search/s name æœç´¢åŒ…
npm install/i name å®‰è£…åŒ…

//å®‰è£…åˆ°ä¾èµ–ä¸­  åŒ…åä¼šè¢«æ³¨å†Œåœ¨package.jsonä¸­çš„dependenciesé‡Œé¢,åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹è¿™ä¸ªåŒ…çš„ä¾èµ–ä¾ç„¶å­˜åœ¨.
//å®‰è£…åŒ…å¹¶æ·»åŠ åˆ°ç”Ÿäº§ä¸­(devdependencies)  6ç‰ˆæœ¬å¯çœç•¥,è‡ªåŠ¨æ·»åŠ åˆ°ä¾èµ–ä¸­
npm i name --save-dev
npm i name -D

//å®‰è£…åŒ…å¹¶æ·»åŠ åˆ°å¼€å‘ä¸­(dependencies)
//
npm i name --save
npm i name -S


npm i name -g å…¨å±€å®‰è£…

npm i/install  å®‰è£…å…¨éƒ¨ä¾èµ–
npm i --production åªå®‰è£…dependenciesä¸­çš„ä¾èµ–

npm remove/r name1 name2 ç§»é™¤åŒ…,å¯ä»¥æ·»åŠ å¤šä¸ªåŒ…çš„åå­—
```



### å°è£… NPM åŒ…

åˆ›å»ºè‡ªå·±çš„ NPM åŒ…å¯ä»¥å¸®åŠ©ä»£ç è¿›è¡Œè¿­ä»£è¿›åŒ–ï¼Œä½¿ç”¨æ­¥éª¤ä¹Ÿæ¯”è¾ƒç®€å•

0. ä¿®æ”¹ä¸ºå®˜æ–¹çš„åœ°å€ (npm config set registry https://registry.npmjs.org/) ä½¿ç”¨éå®˜æ–¹åœ°å€æ—¶æ‰è¦(æ·˜å®é•œåƒæ‰ä½¿ç”¨æ­¤æ­¥)

1. åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»ºæ–‡ä»¶ **index.js**ï¼Œ åœ¨æ–‡ä»¶ä¸­å£°æ˜å‡½æ•°ï¼Œä½¿ç”¨ module.exports æš´éœ²
2. æ–‡ä»¶å¤¹ä¸‹ npm åˆå§‹åŒ–å·¥å…·åŒ…(npm init)ï¼Œpackage.json å¡«å†™åŒ…çš„ä¿¡æ¯
3. è´¦å·æ³¨å†Œï¼ˆæ¿€æ´»è´¦å·ï¼‰,==å®Œæˆé‚®ç®±éªŒè¯==
4. æ–‡ä»¶å¤¹ä¸‹,å‘½ä»¤è¡Œä¸‹ ã€npm loginã€ å¡«å†™ç›¸å…³ç”¨æˆ·ä¿¡æ¯
5. æ–‡ä»¶å¤¹ä¸‹, å‘½ä»¤è¡Œä¸‹ã€ npm publishã€ æäº¤åŒ… ğŸ‘Œ

> npm æœ‰åƒåœ¾æ£€æµ‹æœºåˆ¶ï¼Œå¦‚æœåå­—ç®€å•æˆ–åšæµ‹è¯•æäº¤ï¼Œå¾ˆå¯èƒ½ä¼šè¢«æ‹’ç»æäº¤
>
> ==å¯ä»¥å°è¯•æ”¹ä¸€ä¸‹åŒ…çš„åç§°æ¥è§£å†³è¿™ä¸ªé—®é¢˜==



### å‡çº§npmåŒ…

å‡çº§ NPM åŒ…ï¼Œéœ€è¦ä¿®æ”¹ package.json ä¸­çš„ç‰ˆæœ¬å·ä¿®æ”¹ï¼Œåªéœ€è¦æ‰§è¡Œã€npm publishã€å°±å¯ä»¥èƒ½æäº¤

1. ä¿®æ”¹åŒ…ä»£ç 
2. ä¿®æ”¹ package.json ä¸­ç‰ˆæœ¬å·
3. npm publish æäº¤

### åˆ é™¤ npm åŒ…

```
npm unpublish åŒ…å --force
```



## NPM

### ä»‹ç»

å…¨ç§°ï¼šNode Package Manager , Node çš„åŒ…ç®¡ç†å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚æ˜¯éšåŒNodeJSä¸€èµ·å®‰è£…çš„åŒ…ç®¡ç†å’Œåˆ†å‘å·¥å…·ï¼Œå®ƒå¾ˆæ–¹ä¾¿è®©JavaScriptå¼€å‘è€…ä¸‹è½½ã€å®‰è£…ã€ä¸Šä¼ ä»¥åŠç®¡ç†å·²ç»å®‰è£…çš„åŒ…ã€‚

### åŒ…æ˜¯ä»€ä¹ˆ

Node.js çš„åŒ…åŸºæœ¬éµå¾ª CommonJS è§„èŒƒï¼Œå°†ä¸€ç»„ç›¸å…³çš„æ¨¡å—ç»„åˆåœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å·¥å…·

### ä½œç”¨

é€šè¿‡ NPM å¯ä»¥å¯¹ Node çš„å·¥å…·åŒ…è¿›è¡Œ**æœç´¢ã€ä¸‹è½½ã€å®‰è£…ã€åˆ é™¤ã€ä¸Šä¼ **ã€‚å€ŸåŠ©åˆ«äººå†™å¥½çš„åŒ…ï¼Œå¯ä»¥è®©æˆ‘ä»¬çš„å¼€å‘æ›´åŠ æ–¹ä¾¿ã€‚

### å®‰è£…

å®‰è£…å®Œ nodejs ä¹‹åä¼šè‡ªåŠ¨å®‰è£… npm

è¯¦è§Nodeå®‰è£…æ•™ç¨‹





### èƒŒæ™¯çŸ¥è¯†(å¼€å‘+ç”Ÿäº§)

```js
å¼€å‘ç¯å¢ƒ:é¡¹ç›®å¤„åœ¨ç¼–ç é˜¶æ®µ,
    ç”¨åˆ°çš„è¾…åŠ©å·¥å…·ä¾èµ–å°±å®‰è£…åˆ°devDependenciesä¸‹,ä½¿ç”¨npm install åŒ…å --save-dev(-D)
	ä¾‹å¦‚:cssé¢„å¤„ç†å™¨:Less, Sass, Stylus; ESlint; Webpackæ‰“åŒ…å·¥å…·
    
    
ç”Ÿäº§ç¯å¢ƒ: ä¸Šçº¿æœåŠ¡
	å¦‚æœé¡¹ç›®è¿è¡Œéœ€è¦çš„ä¾èµ–,å°±å®‰è£…åˆ°dependenciesä¸‹, ä½¿ç”¨npm install åŒ…å  --save(-S)
    ä¾‹å¦‚:Vue.js,Reactæ¡†æ¶; axios; ElementUIç»„ä»¶åº“
```



## NPMå¸¸ç”¨å‘½ä»¤

> [CLI Commands | npm Docs (npmjs.com)](https://docs.npmjs.com/cli/v8/commands)

#### æŸ¥çœ‹ npm çš„ç‰ˆæœ¬

```sh
npm -v 
```

#### åˆå§‹åŒ–

//ä¸»è¦æ˜¯ç”¨æ¥åˆ›å»ºpackage.jsonæ–‡ä»¶,å¦‚æœå·²ç»å­˜åœ¨,åˆ™ä¸éœ€è¦é‡æ–°åˆ›å»º.
//åŒ…åå­—ä¸èƒ½ä½¿ç”¨ä¸­æ–‡,å¤§å†™å’Œnpm

##### åŸºç¡€è¯­æ³•

```shell
npm init [-f| --force| -y | --yes]
```



```sh


npm init
//ç®€æ´å†™æ³•, è¾“å…¥éƒ½é‡‡ç”¨é»˜è®¤å€¼
npm init --yes
```

è¿è¡Œåä¼šåˆ›å»º package.json æ–‡ä»¶  //ä¸€èˆ¬æ”¾åœ¨æ ¹ç›®å½•ä¸‹           

```json
{
  "name": "1-npm",      #åŒ…çš„åå­—
  "version": "1.0.0",   #åŒ…çš„ç‰ˆæœ¬
  "description": "",    #åŒ…çš„æè¿°
  "main": "index.js",   #åŒ…çš„å…¥å£æ–‡ä»¶
  "scripts": {			#è„šæœ¬é…ç½®
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "",			#ä½œè€…
  "license": "ISC"		#ç‰ˆæƒå£°æ˜
}
```

> ==æ³¨æ„ç”Ÿæˆçš„åŒ…åä¸èƒ½ä½¿ç”¨ä¸­æ–‡ï¼Œå¤§å†™ ï¼ï¼ï¼ ä¸èƒ½ä½¿ç”¨ npm ä½œä¸ºåŒ…çš„åå­—==

å…³äºå¼€æºè¯ä¹¦æ‰©å±•é˜…è¯»

<http://www.ruanyifeng.com/blog/2011/05/how_to_choose_free_software_licenses.html>

#### æœç´¢

##### æœç´¢
```js
npm search åŒ…å
```

##### æŸ¥çœ‹æœ¬åœ°åŒ…
```js
npm ls åŒ…å
```

##### æŸ¥çœ‹å…¨å±€å®‰è£…çš„åŒ…
```js
npm ls åŒ…å -g
```

##### æŸ¥çœ‹è¿œç¨‹åŒ…
æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬
```js
npm view åŒ…å version
```

æŸ¥çœ‹æ‰€æœ‰çš„ç‰ˆæœ¬
```js
npm view åŒ…å versions
```

æˆ–è€…
```js
npm info åŒ…å
```




### å®‰è£…æ¨¡å—

#### åŸºç¡€è¯­æ³•
```markdown
npm install [<@scope>/]<pkg>
npm install [<@scope>/]<pkg>@<tag>
npm install [<@scope>/]<pkg>@<version>
npm install [<@scope>/]<pkg>@<version range>
npm install <alias>@npm:<name>
npm install <folder>
npm install <tarball file>
npm install <tarball url>
npm install <git:// url>
npm install <github username>/<github project>

aliases: add, i, in, ins, inst, insta, instal, isnt, isnta, isntal, isntall

common options: [-S|--save| -D|--save-dev| -O|--save-optional] [-E| --save-exact] [--dry-run]
            
```

* å®‰è£…åŒ…,é»˜è®¤ä¼šå®‰è£…æœ€æ–°çš„ç‰ˆæœ¬

```tiki wiki
npm install gulp
```

* å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…

```tiki wiki
npm install gulp@3.9.1
```

å®‰è£…åŒ…å¹¶å°†ä¿¡æ¯ä¿æŒåˆ°é¡¹ç›®çš„package.jsonæ–‡ä»¶ä¸­;

* 6ç‰ˆæœ¬çš„ npm ï¼Œå®‰è£…åŒ…æ—¶ä¼šè‡ªåŠ¨ä¿å­˜åœ¨ dependencies ä¸­ï¼Œå¯ä»¥ä¸ç”¨å†™ `--save`

* ä¸€æ¬¡å®‰è£…å¤šä¸ªåŒ…
	å‘½ä»¤è¡Œå¯ä»¥æ·»åŠ å¤šä¸ªåŒ… npm i chalk ludash


* å®‰è£…åŒ…åˆ°ç”Ÿäº§/å¼€å‘ç¯å¢ƒä¾èµ–


å®‰è£…åŒ…ä¿¡æ¯åˆ°**ç”Ÿäº§ç¯å¢ƒ(dependencies)** `-S | -save`

```markdown
//npm5åŠä¹‹å, `npm install`å’Œ`npm install --save`æ˜¯ç­‰ä»·çš„ï¼Œæ‰€ä»¥â€“saveå¯ä»¥çœç•¥

npm i gulp --save
npm i gulp -S
```

package.jsonæ–‡ä»¶çš„ dependencies å­—æ®µï¼š

```shell
## å®‰è£…å¹¶åœ¨ package.json ä¸­ä¿å­˜åŒ…çš„ä¿¡æ¯(dependencies å±æ€§)
"dependencies": { 
    "gulp": "^3.9.1"
}
```



å®‰è£…åŒ…ä¿¡æ¯åˆ°**å¼€å‘ç¯å¢ƒ(devDependencies)** `-D | --save-dev`

```sh
//å®‰è£…å¹¶åœ¨ package.json ä¸­ä¿å­˜åŒ…çš„ä¿¡æ¯(devDependencies å±æ€§) ä¸»è¦ç”¨æ¥ä¿å­˜ä¸€äº›å¼€å‘ä¾èµ–åŒ…,ä¾‹å¦‚webpack
npm i gulp --save-dev
npm i gulp -D
```

package.json æ–‡ä»¶çš„ devDependencieså­—æ®µï¼š

```markdown
"devDependencies": {
    "gulp": "^3.9.1"
}
```



é¡¹ç›®å¯¹æ¨¡å—çš„ä¾èµ–å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ 3 ç§æ–¹æ³•æ¥è¡¨ç¤ºï¼ˆå‡è®¾å½“å‰ç‰ˆæœ¬å·æ˜¯ 1.1.0 ï¼‰ï¼š
- å…¼å®¹æ¨¡å—æ–°å‘å¸ƒçš„è¡¥ä¸ç‰ˆæœ¬ï¼š~1.1.0ã€1.1.xã€1.1
- å…¼å®¹æ¨¡å—æ–°å‘å¸ƒçš„å°ç‰ˆæœ¬ã€è¡¥ä¸ç‰ˆæœ¬ï¼š^1.1.0ã€1.xã€1
- å…¼å®¹æ¨¡å—æ–°å‘å¸ƒçš„å¤§ç‰ˆæœ¬ã€å°ç‰ˆæœ¬ã€è¡¥ä¸ç‰ˆæœ¬ï¼š*ã€x



å®‰è£…åŒ…ä¿¡æ¯åˆ°**å¯é€‰é˜¶æ®µ(optionalDependencies)** `-O | --save-optional`

```markdown
npm i gulp --save-optional
npm i gulp -O
```

package.json æ–‡ä»¶çš„optionalDependencieså­—æ®µï¼š

```markdown
"optionalDependencies": {
    "gulp": "^3.9.1"
}
```

**ç²¾ç¡®å®‰è£…æŒ‡å®šæ¨¡å—**ç‰ˆæœ¬ `-E | --save-exact`

```markdown
npm i gulp --save-exact
npm i gulp -E
```

è¾“å…¥å‘½ä»¤npm install gulp -ESï¼Œç•™æ„package.json æ–‡ä»¶çš„ dependencies å­—æ®µï¼Œä»¥çœ‹å‡ºç‰ˆæœ¬å·ä¸­çš„^æ¶ˆå¤±äº†

```markdown
"dependencies": {
    "gulp": "3.9.1"
}
```



**å…¨å±€å®‰è£…** ä½¿ç”¨`-g` æˆ– `--global`

```shell
//package.jsonæ²¡æœ‰å˜åŒ–,å¯¹å•ä¸ªé¡¹ç›®æ²¡æœ‰å½±å“
//å…¨å±€å®‰è£…ä½ç½®çš„æŸ¥çœ‹å‘½ä»¤: npm root -g æ‰“å°ç»“æœå°±æ˜¯ä¸‹é¢çš„æ–‡ä»¶å¤¹
//å®‰è£…ä½ç½®: .../AppDate/Roaming/npm/node_modles
//ä¼šåˆ›å»ºå…¨å±€çš„å‘½ä»¤: 


npm install less -g
npm install nodemon -g 
```

**å±€éƒ¨å®‰è£…**
å®‰è£…åˆ°å½“å‰é¡¹ç›®ä¸­,å› ä¸ºæ²¡æœ‰å…¨å±€å®‰è£…,ä¸åœ¨ç¯å¢ƒå˜é‡ä¸­,å¯åŠ¨å®‰è£…å‘½ä»¤,å¯ä»¥ä½¿ç”¨`npx åŸå‘½ä»¤`.
```bash
npm i xxx

//å®‰è£…,æ‰§è¡Œå®‰è£…åŒ…å‘½ä»¤
npi i @vue/cli
npx create vue é¡¹ç›®åŒ…å
```



### æŸ¥çœ‹å®‰è£…çš„æ¨¡å—

#### åŸºç¡€è¯­æ³•

```shell
npm ls [[<@scope>/]<pkg> ...]

aliases: list, la, ll
```

æŸ¥çœ‹å…¨å±€å®‰è£…çš„æ¨¡å—åŠä¾èµ–

```shell
npm ls -g
```


#### å®‰è£…ç›¸å…³é—®é¢˜

**1.ä¾èµ–é”™è¯¯ ERESOLVE unable to resolve dependency tree**
æ–°å®‰è£…çš„ä¾èµ–å’Œå·²ç»å®‰è£…çš„ä¾èµ–ä¹‹é—´çš„ç‰ˆæœ¬ä¸é€‚é…,å¼•èµ·äº†å†²çª.
```bash
npm ERR! code ERESOLVE
npm ERR! ERESOLVE unable to resolve dependency tree
npm ERR! 
npm ERR! While resolving: vuecliformat@0.1.0
npm ERR! Found: eslint@7.32.0
npm ERR! node_modules/eslint
npm ERR!   dev eslint@"^7.32.0" from the root project
npm ERR! 
npm ERR! Could not resolve dependency:
npm ERR! peer eslint@">=8.0.0" from eslint-plugin-prettier@5.2.1
npm ERR! node_modules/eslint-plugin-prettier
npm ERR!   dev eslint-plugin-prettier@"*" from the root project
npm ERR!
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR! this command with --force, or --legacy-peer-deps
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR!
npm ERR!
npm ERR!
npm ERR! Fix the upstream dependency conflict, or retry
npm ERR! this command with --force, or --legacy-peer-deps
npm ERR! to accept an incorrect (and potentially broken) dependency resolution.
npm ERR!
npm ERR! See C:\Users\Null\AppData\Local\npm-cache\eresolve-report.txt for a full report.

npm ERR! A complete log of this run can be found in:
npm ERR!     C:\Users\Null\AppData\Local\npm-cache\_logs\2024-08-13T06_30_08_389Z-debug-0.log
```

**è§£å†³æ–¹æ¡ˆ**
æ¨èæ–¹æ³•1å’Œ3

* æ›´æ–°å·²ç»å®‰è£…çš„ä¾èµ–
```bash
npm update eslint -D
```


* ä½¿ç”¨`--legacy-peer-deps`è¯­å¥,å¼ºåˆ¶å¿½ç•¥ä¾èµ–å†²çª
	ä½¿ç”¨ `--legacy-peer-deps`è¯­å¥æ¥å¿½ç•¥å¯¹ç­‰ä¾èµ–å†²çª
```bash
npm install eslint-plugin-prettier eslint-config-prettier -D --legacy-peer-deps
```


* é™çº§`eslint-plugin-prettier`
	é€‰æ‹©æ˜¯å®‰è£…ä¸ä½ å½“å‰ ESLint ç‰ˆæœ¬å…¼å®¹çš„ eslint-plugin-prettier ç‰ˆæœ¬
```bash
npm install eslint-plugin-prettier@4.2.1 eslint-config-prettier -D
```

* ä½¿ç”¨ `--force`è¯­å¥å¼ºåˆ¶å®‰è£…
	è¿™æ˜¯æœ€ä¸æ¨èçš„åšæ³•,å› ä¸ºå®ƒå¯èƒ½ä¼šå¯¼è‡´åŒ…ä¹‹é—´çš„ä¸å…¼å®¹
```bash
npm install eslint-plugin-prettier eslint-config-prettier -D --force
```





### å¸è½½æ¨¡å—

#### åŸºç¡€è¯­æ³•

```html
npm uninstall [<@scope>/]<pkg>[@<version>]... [-S|--save|-D|--save-dev|-O|--save-optional]

aliases: remove, rm, r, un, unlink
```

å¦‚å¸è½½å¼€å‘ç‰ˆæœ¬çš„æ¨¡å—, ä¸€è¡Œå¯ä»¥å†™å¤šä¸ªåŒ…å

```javascript
npm uninstall gulp --save-dev

npm remove jquery
npm remove jquery chalk //å¯ä»¥åœ¨å†™æ³•ä¸Šç§»å‡ºå¤šä¸ªåŒ…
```



### æ›´æ–°æ¨¡å—

#### åŸºç¡€è¯­æ³•

```html
npm update [-g] [<pkg>...]
```



### æ£€æŸ¥æ¨¡å—æ˜¯å¦å·²è¿‡æ—¶

#### åŸºç¡€è¯­æ³•

```html
npm outdated [[<@scope>/]<pkg>...]
```



### å…¨å±€å˜é‡é…ç½®

```js
windowç”µè„‘
ç¯å¢ƒå˜é‡çš„è®¾ç½® pathè·¯å¾„
```





### æŸ¥çœ‹æŸæ¡å‘½ä»¤çš„å¸®åŠ©

#### åŸºç¡€è¯­æ³•

```shell
npm help <term> [<terms..>]
```

ä¾‹å¦‚è¾“å…¥`npm help install`ï¼Œç³»ç»Ÿåœ¨é»˜è®¤çš„æµè§ˆå™¨æˆ–è€…é»˜è®¤çš„ç¼–è¾‘å™¨ä¸­æ‰“å¼€æœ¬åœ°nodejså®‰è£…åŒ…çš„æ–‡ä»¶/nodejs/node_modules/npm/html/doc/cli/npm-install.html



### æŸ¥çœ‹åŒ…å®‰è£…è·¯å¾„

è¾“å‡º node_modulesçš„è·¯å¾„

```shell
npm root [-g]
```

### æŸ¥è¯¢å®‰è£…çš„åŒ…

```js
1.æŸ¥è¯¢å…¨å±€æ˜¯å¦å®‰è£…è¿‡æŸä¸ªåŒ…
npm list åŒ…å -g

2.æŸ¥è¯¢å…¨å±€å®‰è£…è¿‡çš„åŒ…
npm list -g --depth 0
```



## é…ç½®NPM

##### åŸºç¡€è¯­æ³•

 ```shell
 npm config set <key> <value> [-g|--global] 
 npm config get <key>
 npm config delete <key>
 npm config list
 npm config edit
 npm get <key>
 npm set <key> <value> [-g | --global]
 ```

##### NPMè®¾ç½®ä»£ç†åŠä¿®æ”¹é•œåƒ

é¦–å…ˆæŸ¥çœ‹å½“å‰é…ç½®æ˜¯å¦å·²ç»å­˜åœ¨ä»£ç†: 

```javascript
npm config ls   //ls <== listçš„ç¼©å†™
```

è®¾ç½®ç½‘ç»œä»£ç†
npmæ”¯æŒhttpä»£ç†,ä½†socks5ä»£ç†éœ€è¦è½¬æ¢è®¾ç½®
```bash
npm config set proxy "http://127.0.0.1:7890" //ä¸€èˆ¬ä»ä»£ç†è½¯ä»¶ä¸Šè·å–
npm config set https-proxy "http://127.0.0.1:7890"
```

æŸ¥çœ‹ä»£ç†
```bash
npm config get proxy
æˆ–
npm config list
```

[npmè®¾ç½®socks5ä»£ç†](https://zhuanlan.zhihu.com/p/337940332)

```bash
# å®‰è£…è½¬æ¢å·¥å…· è®¾ç½®ä»£ç†ç«¯å£ä¸º7890
npm i -g http-proxy-to-socks
# ç„¶åä½¿ç”¨å·¥å…·ç›‘å¬8002ç«¯å£,æ”¯æŒhttpä»£ç†,ç„¶åæ‰€æœ‰8002çš„httpä»£ç†éƒ½å°†è½¬æ¢æˆsocksä»£ç†å‘é€åˆ°7890ä¸Š
htps -s 127.0.0.1:7890 -p 8002  # éœ€è¦ä¸€ç›´å¼€ç€
# è®¾ç½®npmä»£ç†ä¸º8002
npm config set proxy http://127.0.0.1:7890
npm config set https-proxy http://127.0.0.1:7890
```



å°†npmé»˜è®¤ä¸‹è½½åœ°å€æ›´æ”¹æˆå›½å†…æ·˜å®é•œåƒ

```bash
npm config set registry https://registry.npmmirror.com
```

å†æ¬¡æŸ¥çœ‹ç¡®è®¤æ˜¯å¦æ›´æ”¹

```bash
npm config ls
```

æ›´æ–°

```bash
npm update
```





#### ç®¡ç†æ¨¡å—ç¼“å­˜

åŸºç¡€è¯­æ³•

 ```shell
 npm cache add <tarball file>
 npm cache add <folder>
 npm cache add <tarball url>
 npm cache add <name>@<version>
 
 npm cache ls [<path>]
 
 npm cache clean [<path>]
 ```

æœ€å¸¸ç”¨å‘½ä»¤æ— éæ¸…é™¤npmæœ¬åœ°ç¼“å­˜

 ```shell
 npm cache clean
 ```



#### å¯åŠ¨æ¨¡å—

##### åŸºç¡€è¯­æ³•

 ```shell
 npm start [--<args>]
 ```

è¯¥å‘½ä»¤å†™åœ¨package.jsonæ–‡ä»¶scriptsçš„startå­—æ®µä¸­ï¼Œå¯ä»¥è‡ªå®šä¹‰å‘½ä»¤æ¥é…ç½®ä¸€ä¸ªæœåŠ¡å™¨ç¯å¢ƒå’Œå®‰è£…ä¸€ç³»åˆ—çš„å¿…è¦ç¨‹åºï¼Œå¦‚

```json
"scripts": {
    "start": "gulp -ws"
}
```

æ­¤æ—¶åœ¨cmdä¸­è¾“å…¥npm startå‘½ä»¤ç›¸å½“äºæ‰§è¡Œgulpfile.jsæ–‡ä»¶è‡ªå®šä¹‰çš„watchå’Œserverå‘½ä»¤ã€‚

å¦‚æœpackage.jsonæ–‡ä»¶æ²¡æœ‰è®¾ç½®startï¼Œåˆ™å°†ç›´æ¥å¯åŠ¨node server.js



#### åœæ­¢æ¨¡å—

##### åŸºç¡€è¯­æ³•

```shell
npm stop [-- <args>]
```



#### é‡æ–°å¯åŠ¨æ¨¡å—

##### åŸºç¡€è¯­æ³•

 ```shell
 npm restart [--<args>]
 ```



#### æµ‹è¯•æ¨¡å—

##### åŸºç¡€è¯­æ³•

```
npm test [-- <args>]
npm tst [-- <args>]
```

è¯¥å‘½ä»¤å†™åœ¨package.jsonæ–‡ä»¶scriptsçš„testå­—æ®µä¸­ï¼Œå¯ä»¥è‡ªå®šä¹‰è¯¥å‘½ä»¤æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œå¦‚

```
"scripts": {
    "test": "gulp release"
},
```

æ­¤æ—¶åœ¨cmdä¸­è¾“å…¥npm testå‘½ä»¤ç›¸å½“äºæ‰§è¡Œgulpfile.jsæ–‡ä»¶è‡ªå®šä¹‰çš„releaseå‘½ä»¤ã€‚






### npxä»‹ç»
> https://github.com/LightXJ/blog/issues/28

#### æ˜¯ä»€ä¹ˆ
npmä»5.2ç‰ˆå¼€å§‹ï¼Œå¢åŠ äº†npxå‘½ä»¤ã€‚å®ƒæœ‰å¾ˆå¤šç”¨å¤„ï¼Œæœ¬æ–‡ä»‹ç»è¯¥å‘½ä»¤ä¸»è¦ä½¿ç”¨åœºæ™¯ã€‚  
Nodeè‡ªå¸¦npmæ¨¡å—ï¼Œnpxåˆæ˜¯npmçš„è‡ªå¸¦æ¨¡å—ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨npxå‘½ä»¤ã€‚ä¸‡ä¸€ä¸èƒ½ï¼Œå¯ä»¥æ‰‹åŠ¨å®‰è£…ä¸º  
`npm install -g npx`

#### ä½œç”¨
**è°ƒç”¨é¡¹ç›®å®‰è£…çš„æ¨¡å—**
npxæƒ³è¦è§£å†³çš„ä¸»è¦é—®é¢˜ï¼Œå°±æ˜¯è°ƒç”¨é¡¹ç›®å†…éƒ¨å®‰è£…çš„æ¨¡å—ã€‚æ¯”å¦‚ï¼Œé¡¹ç›®å†…éƒ¨å®‰è£…äº†æµ‹è¯•å·¥å…·Mocha  
`npm install -d mocha`  
ä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨Mocha,åªèƒ½åœ¨é¡¹ç›®è„šæœ¬å’Œpackage.jsonçš„scriptså­—æ®µé‡Œé¢ï¼Œå¦‚æœæƒ³åœ¨å‘½ä»¤è¡Œä¸‹è°ƒç”¨ï¼Œå¿…é¡»åƒä¸‹é¢

```js
# é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œ
$ node-modules/.bin/mocha --version
```

npxå°±æ˜¯æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®©é¡¹ç›®å†…éƒ¨å®‰è£…çš„æ¨¡å—ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼Œåªè¦åƒä¸‹é¢è¿™æ ·è°ƒç”¨å°±è¡Œäº†ã€‚

```js
npx mocha --version
```

**é¿å…å…¨å±€å®‰è£…**
é™¤äº†è°ƒç”¨é¡¹ç›®å†…éƒ¨æ¨¡å—ï¼Œnpxè¿˜èƒ½é¿å…å…¨å±€å®‰è£…çš„æ¨¡å—ã€‚æ¯”å¦‚ï¼Œcreate-react-appè¿™ä¸ªæ¨¡å—æ˜¯å…¨å±€å®‰è£…ï¼Œnpxå¯ä»¥è¿è¡Œå®ƒï¼Œè€Œä¸”ä¸è¿›è¡Œå…¨å±€å®‰è£…ã€‚  
`npx create-react-app my-react-app`  
ä¸Šé¢ä»£ç è¿è¡Œæ—¶ï¼Œnpxå°†create-react-appä¸‹è½½åˆ°ä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œä½¿ç”¨ä»¥åå†åˆ é™¤ã€‚æ‰€ä»¥ï¼Œä»¥åå†æ¬¡æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ï¼Œä¼šé‡æ–°ä¸‹è½½create-react-app

ä¸‹è½½å…¨å±€æ¨¡å—æ—¶ï¼Œnpxå…è®¸æŒ‡å®šç‰ˆæœ¬  
`npx uglify-js@3.1.0 main.js -o ./dist/main.js`  
ä¸Šé¢ä»£ç æŒ‡å®šä½¿ç”¨3.1.0ç‰ˆæœ¬çš„uglify-jså‹ç¼©è„šæœ¬  
æ³¨æ„ï¼Œåªè¦npxåé¢çš„æ¨¡å—æ— æ³•åœ¨æœ¬åœ°å‘ç°ï¼Œå°±ä¼šä¸‹è½½åŒåæ¨¡å—ã€‚æ¯”å¦‚ï¼Œæœ¬åœ°æ²¡æœ‰å®‰è£…http-serveræ¨¡å—ï¼Œä¸‹é¢çš„å‘½ä»¤ä¼šè‡ªåŠ¨ä¸‹è½½è¯¥æ¨¡å—ï¼Œåœ¨å½“å‰ç›®å½•å¯åŠ¨ä¸€ä¸ªwebæœåŠ¡ã€‚  
`npx http-server`

#### é…ç½®




## package.json

#### èµ„æ–™

> è‹±æ–‡åŸç‰ˆï¼šhttps://docs.npmjs.com/files/package.json
>
> å›½å†…æ•´ç†ï¼šã€Š[npmçš„package.jsonä¸­æ–‡æ–‡æ¡£](https://github.com/ericdum/mujiang.info/issues/6/)ã€‹



#### æ˜¯ä»€ä¹ˆ

å¤§å®¶éƒ½çŸ¥é“ï¼Œ**`package.json ç”¨æ¥æè¿°é¡¹ç›®åŠé¡¹ç›®æ‰€ä¾èµ–çš„æ¨¡å—ä¿¡æ¯ã€‚`**ï¼Œå°±æ˜¯å¸®æˆ‘ä»¬ç®¡ç†é¡¹ç›®ä¸­çš„ä¾èµ–åŒ…çš„ï¼Œè®©æˆ‘ä»¬è¿œç¦»äº†ä¾èµ–åœ°ç‹±ã€‚

package.jsonæ˜¯ç®¡ç†å…¶ä¾èµ–çš„é…ç½®æ–‡ä»¶, åˆå§‹åŒ–é¡¹ç›®æ—¶, ä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆ3ä¸ªç›®å½•/æ–‡ä»¶:

* node_modules
* package.json
* package.lock.json



#### package-lcok.json

æœ¬è´¨ä¸Špackage-lock.jsonæ–‡ä»¶æ˜¯ä¸ºäº†é”ç‰ˆæœ¬, åœ¨package.jsonä¸­æŒ‡å®šçš„å­npmåŒ…æ¯”å¦‚ï¼šreact: "^16.0.0"ï¼Œåœ¨å®é™…å®‰è£…ä¸­ï¼Œåªè¦é«˜äºreactçš„ç‰ˆæœ¬éƒ½æ»¡è¶³package.jsonçš„è¦æ±‚ã€‚è¿™æ ·å°±ä½¿å¾—æ ¹æ®åŒä¸€ä¸ªpackage.jsonæ–‡ä»¶ï¼Œä¸¤æ¬¡å®‰è£…çš„å­ä¾èµ–ç‰ˆæœ¬ä¸èƒ½ä¿è¯ä¸€è‡´ã€‚





#### package.json å¸¸ç”¨å±æ€§

ä»¥ä¸‹æŒ‡ç¤ºé€‰å–äº†å…¶ä¸­å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å­—æ®µ:

**name**

åœ¨package.jsonä¸­æœ€é‡è¦çš„å°±æ˜¯nameå’Œversionå­—æ®µã€‚ä»–ä»¬éƒ½æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœæ²¡æœ‰å°±æ— æ³•installã€‚nameå’Œversionä¸€èµ·ç»„æˆçš„æ ‡è¯†åœ¨å‡è®¾ä¸­æ˜¯å”¯ä¸€çš„ã€‚æ”¹å˜åŒ…åº”è¯¥åŒæ—¶æ”¹å˜versionã€‚

nameæ˜¯è¿™ä¸ªä¸œè¥¿çš„åå­—ã€‚æ³¨æ„ï¼š

- ä¸è¦æŠŠnodeæˆ–è€…jsæ”¾åœ¨åå­—ä¸­ã€‚å› ä¸ºä½ å†™äº†package.jsonå®ƒå°±è¢«å‡å®šæˆä¸ºäº†jsï¼Œä¸è¿‡ä½ å¯ä»¥ç”¨"engine"å­—æ®µæŒ‡å®šä¸€ä¸ªå¼•æ“ï¼ˆè§åæ–‡ï¼‰ã€‚
- è¿™ä¸ªåå­—ä¼šä½œä¸ºåœ¨URLçš„ä¸€éƒ¨åˆ†ã€å‘½ä»¤è¡Œçš„å‚æ•°æˆ–è€…æ–‡ä»¶å¤¹çš„åå­—ã€‚ä»»ä½•non-url-safeçš„å­—ç¬¦éƒ½æ˜¯ä¸èƒ½ç”¨çš„ã€‚
- è¿™ä¸ªåå­—å¯èƒ½ä¼šä½œä¸ºå‚æ•°è¢«ä¼ å…¥require()ï¼Œæ‰€ä»¥å®ƒåº”è¯¥æ¯”è¾ƒçŸ­ï¼Œä½†ä¹Ÿè¦æ„ä¹‰æ¸…æ™°ã€‚
- åœ¨ä½ çˆ±ä¸Šä½ çš„åå­—ä¹‹å‰ï¼Œä½ å¯èƒ½è¦å»npm registryæŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåå­—æ˜¯å¦å·²ç»è¢«ä½¿ç”¨äº†ã€‚http://registry.npmjs.org/

**version**

versionå¿…é¡»èƒ½è¢«[node-semver](https://github.com/isaacs/node-semver)è§£æï¼Œå®ƒè¢«åŒ…åœ¨npmçš„ä¾èµ–ä¸­ã€‚ï¼ˆè¦è‡ªå·±ç”¨å¯ä»¥æ‰§è¡Œ`npm install semver`ï¼‰

**scripts**

åœ¨npmä¸­ä½¿ç”¨scriptæ ‡ç­¾æ¥å®šä¹‰è„šæœ¬ï¼Œæ¯å½“åˆ¶å®šnpm runçš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªshellè„šæœ¬ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œnpm runæ–°å»ºçš„è¿™ä¸ª Shellï¼Œä¼šå°†æœ¬åœ°ç›®å½•çš„node_modules/.binå­ç›®å½•åŠ å…¥PATHå˜é‡ã€‚

è¿™æ„å‘³ç€ï¼Œå½“å‰ç›®å½•çš„node_modules/.binå­ç›®å½•é‡Œé¢çš„æ‰€æœ‰è„šæœ¬ï¼Œéƒ½å¯ä»¥ç›´æ¥ç”¨è„šæœ¬åè°ƒç”¨ï¼Œè€Œä¸å¿…åŠ ä¸Šè·¯å¾„ã€‚æ¯”å¦‚ï¼Œå½“å‰é¡¹ç›®çš„ä¾èµ–é‡Œé¢æœ‰ esbuildï¼Œåªè¦ç›´æ¥å†™esbuild xxx å°±å¯ä»¥äº†ã€‚

ä»¥ä¸‹ä¸¤ç§å†™æ³•éƒ½æ˜¯ç­‰ä»·çš„:

```json
{
//...  

"script" : {
  "build": "esbuild index.js"
}

}
```



```json
{
  //...
  "script": {
    "build": "./node_modules/.bin/esbuild index.js"
  }
}
```

<span style="color:blue">æ³¨æ„äº‹é¡¹:</span>
å¦‚æœæˆ‘åœ¨é¡¹ç›®ä¸‹åªæ˜¯å®‰è£…ä¸€ä¸ªå±€éƒ¨åŒ…,é‚£ä¹ˆæˆ‘è¿è¡Œè¿™ä¸ªåŒ…å‘½ä»¤çš„è¯,ä¼šæ˜¾ç¤ºnpmæ— æ³•è¯†åˆ«è¿™ä¸ªå‘½ä»¤.(å¾…ä¸Šä¼ ä¸€ä¸ªå®ä¾‹å›¾ç‰‡...)
åŸå› ? [[#å¸ƒå±€å®‰è£…çš„åŒ…çš„å‘½ä»¤æ— æ³•åˆ«è¯†åˆ«]]




**bin**

binå±æ€§ç”¨æ¥å°†å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å…¨å±€ç¯å¢ƒä¸­ï¼ŒæŒ‡å®šäº†binå­—æ®µçš„npmåŒ…ï¼Œä¸€æ—¦åœ¨å…¨å±€å®‰è£…ï¼Œå°±ä¼šè¢«åŠ è½½åˆ°å…¨å±€ç¯å¢ƒä¸­ï¼Œå¯ä»¥é€šè¿‡åˆ«åæ¥æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚

æ¯”å¦‚\@bytepack/cliçš„npmåŒ…ï¼š

```json
"bin": {
    "bytepack": "./bin/index.js"
 },
```

ä¸€æ—¦åœ¨å…¨å±€å®‰è£…äº†@bytepack/cliï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡bytepackæ¥æ‰§è¡Œç›¸åº”çš„å‘½ä»¤ï¼Œæ¯”å¦‚

```bash
bytepack -v
// æ˜¾ç¤º1.11.0
```

å¦‚æœéå…¨å±€å®‰è£…ï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨è¿æ¥åˆ°é¡¹ç›®çš„node_module/.binç›®å½•ä¸­ã€‚ä¸å‰é¢ä»‹ç»çš„scriptæ ‡ç­¾ä¸­æ‰€è¯´çš„ä¸€è‡´ï¼Œå¯ä»¥ç›´æ¥ç”¨åˆ«åæ¥ä½¿ç”¨ã€‚





**workspaces**  ???

workspacesè§£å†³äº†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­å¦‚ä½•åœ¨ä¸€ä¸ªé¡¶å±‚root packageä¸‹ç®¡ç†å¤šä¸ªå­packagesçš„é—®é¢˜ï¼Œåœ¨workspaceså£°æ˜ç›®å½•ä¸‹çš„packageä¼šè½¯é“¾åˆ°æœ€ä¸Šå±‚root packageçš„node_modulesä¸­





#### package.jsonç¯å¢ƒç›¸å…³å±æ€§

å¸¸è§çš„ç¯å¢ƒï¼ŒåŸºæœ¬ä¸Šåˆ†ä¸ºæµè§ˆå™¨browserå’Œnodeç¯å¢ƒä¸¤å¤§ç±»ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹package.jsonä¸­ï¼Œè·Ÿç¯å¢ƒç›¸å…³çš„é…ç½®å±æ€§ã€‚ç¯å¢ƒçš„å®šä¹‰å¯ä»¥ç®€å•ç†è§£å¦‚ä¸‹ï¼š

- browserç¯å¢ƒï¼šæ¯”å¦‚å­˜åœ¨ä¸€äº›åªæœ‰åœ¨æµè§ˆå™¨ä¸­æ‰ä¼šå­˜åœ¨çš„å…¨å±€å˜é‡ç­‰ï¼Œæ¯”å¦‚windowï¼ŒDocumentç­‰
- nodeç¯å¢ƒ: npmåŒ…çš„æºæ–‡ä»¶ä¸­å­˜åœ¨åªæœ‰åœ¨nodeç¯å¢ƒä¸­æ‰ä¼šæœ‰çš„ä¸€äº›å˜é‡å’Œå†…ç½®åŒ…ï¼Œå†…ç½®å‡½æ•°ç­‰ã€‚



**type**

jsçš„æ¨¡å—åŒ–è§„èŒƒåŒ…å«äº†commonjsã€CMDã€UMDã€AMDå’ŒES moduleç­‰, ä»node13.2.0å¼€å§‹åï¼Œnodeæ­£å¼æ”¯æŒäº†ES moduleè§„èŒƒï¼Œåœ¨package.jsonä¸­å¯ä»¥é€šè¿‡typeå­—æ®µæ¥å£°æ˜npmåŒ…éµå¾ªçš„æ¨¡å—åŒ–è§„èŒƒã€‚

package.json

```json
{
   name: "some package",
   type: "module"||"commonjs" 
}
```

- ä¸æŒ‡å®štypeçš„æ—¶å€™ï¼Œtypeçš„é»˜è®¤å€¼æ˜¯commonjsï¼Œä¸è¿‡å»ºè®®npmåŒ…éƒ½æŒ‡å®šä¸€ä¸‹type
- å½“typeå­—æ®µæŒ‡å®šå€¼ä¸ºmoduleåˆ™é‡‡ç”¨ESModuleè§„èŒƒ
- å½“typeå­—æ®µæŒ‡å®šæ—¶ï¼Œç›®å½•ä¸‹çš„æ‰€æœ‰.jsåç¼€ç»“å°¾çš„æ–‡ä»¶ï¼Œéƒ½éµå¾ªtypeæ‰€æŒ‡å®šçš„æ¨¡å—åŒ–è§„èŒƒ
- é™¤äº†typeå¯ä»¥æŒ‡å®šæ¨¡å—åŒ–è§„èŒƒå¤–ï¼Œé€šè¿‡æ–‡ä»¶çš„åç¼€æ¥æŒ‡å®šæ–‡ä»¶æ‰€éµå¾ªçš„æ¨¡å—åŒ–è§„èŒƒï¼Œä»¥.mjsç»“å°¾çš„æ–‡ä»¶å°±æ˜¯ä½¿ç”¨çš„ESModuleè§„èŒƒï¼Œä»¥.cjsç»“å°¾çš„éµå¾ªçš„æ˜¯commonjsè§„èŒƒ



**main /  modules  /browser**

- main : å®šä¹‰äº† npm åŒ…çš„å…¥å£æ–‡ä»¶ï¼Œbrowser ç¯å¢ƒå’Œ node ç¯å¢ƒå‡å¯ä½¿ç”¨
- module : å®šä¹‰ npm åŒ…çš„ ESM è§„èŒƒçš„å…¥å£æ–‡ä»¶ï¼Œbrowser ç¯å¢ƒå’Œ node - ç¯å¢ƒå‡å¯ä½¿ç”¨
- browser : å®šä¹‰ npm åŒ…åœ¨ browser ç¯å¢ƒä¸‹çš„å…¥å£æ–‡ä»¶

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™3ä¸ªå­—æ®µçš„ä½¿ç”¨åœºæ™¯ï¼Œä»¥åŠåŒæ—¶å­˜åœ¨è¿™3ä¸ªå­—æ®µæ—¶çš„ä¼˜å…ˆçº§ã€‚æˆ‘ä»¬å‡è®¾æœ‰ä¸€ä¸ªnpmåŒ…ä¸ºdemo1,

```bash
----- dist
   |-- index.browser.js
   |-- index.browser.mjs
   |-- index.js
   |-- index.mjs
```



å…¶package.jsonä¸­åŒæ—¶æŒ‡å®šäº†main,moduleå’Œbrowserè¿™3ä¸ªå­—æ®µï¼Œ

```json
  "main": "dist/index.js",  // main 
  "module": "dist/index.mjs", // module

  // browser å¯å®šä¹‰æˆå’Œ main/module å­—æ®µä¸€ä¸€å¯¹åº”çš„æ˜ å°„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰ä¸ºå­—ç¬¦ä¸²
  "browser": {
    "./dist/index.js": "./dist/index.browser.js", // browser+cjs
    "./dist/index.mjs": "./dist/index.browser.mjs"  // browser+mjs
  },

  // "browser": "./dist/index.browser.js" // browser
```

é»˜è®¤æ„å»ºå’Œä½¿ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¼•ç”¨è¿™ä¸ªnpmåŒ…ï¼š

é€šè¿‡æ„å»ºå·¥å…·æ„å»ºä¸Šè¿°ä»£ç åï¼Œæ¨¡å—çš„åŠ è½½å¾ªåºä¸ºï¼š_**browser+mjs > module > browser+cjs > main**_è¿™ä¸ªåŠ è½½é¡ºåºæ˜¯å¤§éƒ¨åˆ†æ„å»ºå·¥å…·é»˜è®¤çš„åŠ è½½é¡ºåºï¼Œæ¯”å¦‚webapckã€esbuildç­‰ç­‰ã€‚å¯ä»¥é€šè¿‡ç›¸åº”çš„é…ç½®ä¿®æ”¹è¿™ä¸ªåŠ è½½é¡ºåºï¼Œä¸è¿‡å¤§éƒ¨åˆ†åœºæ™¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šéµå¾ªé»˜è®¤çš„åŠ è½½é¡ºåºã€‚



**exports**

å¦‚æœåœ¨package.jsonä¸­å®šä¹‰äº†exportså­—æ®µï¼Œé‚£ä¹ˆè¿™ä¸ªå­—æ®µæ‰€å®šä¹‰çš„å†…å®¹å°±æ˜¯è¯¥npmåŒ…çš„çœŸå®å’Œå…¨éƒ¨çš„å¯¼å‡ºï¼Œä¼˜å…ˆçº§ä¼šé«˜äºmainå’Œfileç­‰å­—æ®µã€‚

```json
{
  "name": "pkg",
  "exports": {
    ".": "./main.mjs",
    "./foo": "./foo.js"
  }
}
```



```javascript
import { something } from "pkg"; // from "pkg/main.mjs"
```



```javascript
const { something } = require("pkg/foo"); // require("pkg/foo.js")
```

ä»ä¸Šè¿°çš„ä¾‹å­æ¥çœ‹ï¼Œexportså¯ä»¥å®šä¹‰ä¸åŒpathçš„å¯¼å‡ºã€‚å¦‚æœå­˜åœ¨exportsåï¼Œä»¥å‰æ­£å¸¸ç”Ÿæ•ˆçš„fileç›®å½•åˆ°å¤„ä¼šå¤±æ•ˆï¼Œæ¯”å¦‚require('pkg/package.json')ï¼Œå› ä¸ºåœ¨exportsä¸­æ²¡æœ‰æŒ‡å®šï¼Œå°±ä¼šæŠ¥é”™ã€‚  exportsè¿˜æœ‰ä¸€ä¸ªæœ€å¤§çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯æ¡ä»¶å¼•ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„å¼•ç”¨æ–¹å¼æˆ–è€…æ¨¡å—åŒ–ç±»å‹ï¼Œæ¥æŒ‡å®šnpmåŒ…å¼•ç”¨ä¸åŒçš„å…¥å£æ–‡ä»¶ã€‚

```json
// package.json
{ 
  "name":"pkg",
  "main": "./main-require.cjs",
  "exports": {
    "import": "./main-module.js",
    "require": "./main-require.cjs"
  },
  "type": "module"
}
```

ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œå¦‚æœæˆ‘ä»¬é€šè¿‡

```
const p = require('pkg')
```

å¼•ç”¨çš„å°±æ˜¯"./main-require.cjs"ã€‚å¦‚æœé€šè¿‡ï¼š

```
import p from 'pkg'
```

å¼•ç”¨çš„å°±æ˜¯"./main-module.js"æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ ï¼š***å¦‚æœå­˜åœ¨exportså±æ€§ï¼Œexportså±æ€§ä¸ä»…ä¼˜å…ˆçº§é«˜äºmainï¼ŒåŒæ—¶ä¹Ÿé«˜äºmoduleå’Œbrowserå­—æ®µã€‚***





#### package.jsonä¾èµ–ç›¸å…³å±æ€§

package.jsonä¸­è·Ÿä¾èµ–ç›¸å…³çš„é…ç½®å±æ€§åŒ…å«äº†dependenciesã€devDependenciesã€peerDependencieså’ŒpeerDependenciesMetaç­‰ã€‚

dependenciesæ˜¯é¡¹ç›®çš„ä¾èµ–ï¼Œè€ŒdevDependenciesæ˜¯å¼€å‘æ‰€éœ€è¦çš„æ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦çš„å®‰è£…ä¸Šå»ï¼Œæ¥æé«˜æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ—¶ï¼Œåœ¨è‡ªå·±çš„é¡¹ç›®ä¸­å°½é‡çš„è§„èŒƒä½¿ç”¨ï¼Œå½¢å¦‚webpackã€babelç­‰æ˜¯å¼€å‘ä¾èµ–ï¼Œè€Œä¸æ˜¯é¡¹ç›®æœ¬èº«çš„ä¾èµ–ï¼Œä¸è¦æ”¾åœ¨dependenciesä¸­ã€‚



**dependencies**

ä¾èµ–æ˜¯ç»™ä¸€ç»„åŒ…åæŒ‡å®šç‰ˆæœ¬èŒƒå›´çš„ä¸€ä¸ªhashã€‚è¿™ä¸ªç‰ˆæœ¬èŒƒå›´æ˜¯ä¸€ä¸ªç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åˆ†éš”çš„å­—ç¬¦ä¸²ã€‚ä¾èµ–è¿˜å¯ä»¥ç”¨tarballæˆ–è€…git URLã€‚

è¯·ä¸è¦å°†æµ‹è¯•æˆ–è¿‡æ¸¡æ€§çš„ä¾èµ–æ”¾åœ¨`dependencies`hashä¸­

**devDependencies**

å¦‚æœæœ‰äººè¦ä½¿ç”¨ä½ çš„æ¨¡å—ï¼Œé‚£ä¹ˆä»–ä»¬å¯èƒ½ä¸éœ€è¦ä½ å¼€å‘ä½¿ç”¨çš„å¤–éƒ¨æµ‹è¯•æˆ–è€…æ–‡æ¡£æ¡†æ¶ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½å°†è¿™äº›é™„å±çš„é¡¹ç›®åˆ—åœ¨`devDependencies`ä¸­ã€‚

è¿™äº›ä¸œè¥¿ä¼šåœ¨æ‰§è¡Œ`npm link`æˆ–è€…`npm install`çš„æ—¶å€™åˆå§‹åŒ–ï¼Œå¹¶å¯ä»¥åƒå…¶ä»–npmé…ç½®å‚æ•°ä¸€æ ·ç®¡ç†ã€‚



**peerDependencies**

peerDependenciesæ˜¯package.jsonä¸­çš„ä¾èµ–é¡¹,å¯ä»¥è§£å†³æ ¸å¿ƒåº“è¢«ä¸‹è½½å¤šæ¬¡ï¼Œä»¥åŠç»Ÿä¸€æ ¸å¿ƒåº“ç‰ˆæœ¬çš„é—®é¢˜ã€‚

```json
//package/pkg
----- node_modules
   |-- npm-a -> ä¾èµ–äº†react,react-dom
   |-- npm-b -> ä¾èµ–äº†react,react-dom
   |-- index.js
```

æ¯”å¦‚ä¸Šè¿°çš„ä¾‹å­ä¸­å¦‚æœå­npmåŒ…a,béƒ½ä»¥æ¥äº†reactå’Œreact-dom,æ­¤æ—¶å¦‚æœæˆ‘ä»¬åœ¨å­npmåŒ…a,bçš„package.jsonä¸­å£°æ˜äº†PeerDependiciesåï¼Œç›¸åº”çš„ä¾èµ–å°±ä¸ä¼šé‡æ–°å®‰è£…ã€‚éœ€è¦æ³¨æ„çš„æœ‰ä¸¤ç‚¹ï¼š









**peerDependenciesMeta**

çœ‹åˆ°â€œMetaâ€å°±æœ‰å…ƒæ•°æ®çš„æ„æ€ï¼Œè¿™é‡Œçš„peerDependenciesMetaå°±æ˜¯è¯¦ç»†ä¿®é¥°äº†peerDependiciesï¼Œæ¯”å¦‚åœ¨react-reduxè¿™ä¸ªnpmåŒ…ä¸­çš„package.jsonä¸­æœ‰è¿™ä¹ˆä¸€æ®µï¼š

```json
 "peerDependencies": {
    "react": "^16.8.3 || ^17 || ^18"
  },
 "peerDependenciesMeta": {
    "react-dom": {
      "optional": true
    },
    "react-native": {
      "optional": true
    }
  }
```

è¿™é‡ŒæŒ‡å®šäº†"react-dom","react-native"åœ¨peerDependenciesMetaä¸­ï¼Œä¸”ä¸ºå¯é€‰é¡¹ï¼Œå› æ­¤å¦‚æœé¡¹ç›®ä¸­æ£€æµ‹æ²¡æœ‰å®‰è£…"react-dom"å’Œ"react-native"éƒ½ä¸ä¼šæŠ¥é”™ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡peerDependenciesMetaæˆ‘ä»¬ç¡®å®æ˜¯å–æ¶ˆäº†é™åˆ¶ï¼Œä½†æ˜¯è¿™é‡Œç»å¸¸å­˜åœ¨éAå³Bçš„åœºæ™¯ï¼Œæ¯”å¦‚ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯â€œreact-domâ€å’Œ"react-native"éœ€è¦å®‰è£…ä¸€ä¸ªï¼Œä½†æ˜¯å®é™…ä¸Šé€šè¿‡ä¸Šè¿°çš„å£°æ˜ï¼Œæˆ‘ä»¬å®ç°ä¸äº†è¿™ç§æç¤ºã€‚







#### ç‰ˆæœ¬å·

> å…¬ä¼—å·: ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—

ç‰ˆæœ¬å·ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š`major.minor.patch`ï¼Œä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è¡¥ç‰ˆæœ¬å·ã€‚

ä¾‹å¦‚ï¼š1.2.3ï¼Œä¸»è¦ç‰ˆæœ¬1ï¼Œæ¬¡è¦ç‰ˆæœ¬2ï¼Œè¡¥ä¸3ã€‚

- `è¡¥ä¸`ä¸­çš„æ›´æ”¹è¡¨ç¤ºä¸ä¼šç ´åä»»ä½•å†…å®¹çš„é”™è¯¯ä¿®å¤ã€‚
- `æ¬¡è¦ç‰ˆæœ¬`çš„æ›´æ”¹è¡¨ç¤ºä¸ä¼šç ´åä»»ä½•å†…å®¹çš„æ–°åŠŸèƒ½ã€‚
- `ä¸»è¦ç‰ˆæœ¬`çš„æ›´æ”¹ä»£è¡¨äº†ä¸€ä¸ªç ´åå…¼å®¹æ€§çš„å¤§å˜åŒ–ã€‚å¦‚æœç”¨æˆ·ä¸é€‚åº”ä¸»è¦ç‰ˆæœ¬æ›´æ”¹ï¼Œåˆ™å†…å®¹å°†æ— æ³•æ­£å¸¸å·¥ä½œã€‚

#### å®‰è£…ä¾èµ–åŒ…çš„ç‰ˆæœ¬å¦‚ä½•æŒ‡å®š

`~` ä¼šåŒ¹é…æœ€è¿‘çš„å°ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œæ¯”å¦‚ ~1.2.3 ä¼šåŒ¹é…æ‰€æœ‰ 1.2.x ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ 1.3.0

`^` ä¼šåŒ¹é…æœ€æ–°çš„å¤§ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œæ¯”å¦‚ ^1.2.3 ä¼šåŒ¹é…æ‰€æœ‰ 1.x.x çš„åŒ…ï¼ŒåŒ…æ‹¬ 1.3.0ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬ 2.0.0

`*` å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ä¾èµ–åŒ…ï¼Œæ¯”å¦‚ *1.2.3 ä¼šåŒ¹é… x.x.xï¼Œ



ä½ å¯ä»¥`æŒ‡å®šç‰¹å®šçš„ç‰ˆæœ¬å·`ï¼Œç›´æ¥å†™1.2.3ï¼Œå‰é¢**ä»€ä¹ˆå‰ç¼€éƒ½æ²¡æœ‰**ï¼Œè¿™æ ·å›ºç„¶æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœä¾èµ–åŒ…å‘å¸ƒæ–°ç‰ˆæœ¬ä¿®å¤äº†ä¸€äº›å°bugï¼Œé‚£ä¹ˆéœ€è¦æ‰‹åŠ¨ä¿®æ”¹package.jsonæ–‡ä»¶ï¼›`~` å’Œ `^` åˆ™å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

ä½†æ˜¯éœ€è¦æ³¨æ„ ^ ç‰ˆæœ¬æ›´æ–°å¯èƒ½æ¯”è¾ƒå¤§ï¼Œä¼šé€ æˆé¡¹ç›®ä»£ç é”™è¯¯ï¼Œ **å»ºè®®ä½¿ç”¨ `~` æ¥æ ‡è®°ç‰ˆæœ¬å·**ï¼Œè¿™æ ·å¯ä»¥ä¿è¯é¡¹ç›®ä¸ä¼šå‡ºç°å¤§çš„é—®é¢˜ï¼Œä¹Ÿèƒ½ä¿è¯åŒ…ä¸­çš„å°bugå¯ä»¥å¾—åˆ°ä¿®å¤ã€‚

ç‰ˆæœ¬å·å†™ *ï¼Œè¿™æ„å‘³ç€å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ä¾èµ–åŒ…ï¼Œä½†ç¼ºç‚¹åŒä¸Šï¼Œå¯èƒ½ä¼šé€ æˆç‰ˆæœ¬ä¸å…¼å®¹ï¼Œ**æ…ç”¨ï¼**



#### å¤šäººå¼€å‘æ—¶ä¾èµ–åŒ…å®‰è£…çš„é—®é¢˜

åœºæ™¯ä»‹ç»:

å‡è®¾æˆ‘ä»¬ä¸­å®‰è£…äº† `vue`, å½“æˆ‘ä»¬è¿è¡Œå®‰è£… `npm install vue -save` çš„æ—¶å€™ï¼Œåœ¨é¡¹ç›®ä¸­çš„package.json çš„ vue ç‰ˆæœ¬æ˜¯  `vue: ^3.0.0`,ï¼Œvue å‘å¸ƒäº†æ–°ç‰ˆæœ¬ 3.0.1ï¼Œè¿™æ—¶æ–°æ¥ä¸€ä¸ªåŒäº‹ï¼Œä»æ–° `git clone` å…‹éš†é¡¹ç›®ï¼Œæ‰§è¡Œ `npm install`å®‰è£…çš„æ—¶å€™ï¼Œåœ¨ä»–ç”µè„‘çš„vueç‰ˆæœ¬å°±æ˜¯ 3.0.1äº†ï¼Œå› ä¸º^åªæ˜¯é”äº†ä¸»è¦ç‰ˆæœ¬ï¼Œè¿™æ ·æˆ‘ä»¬ç”µè„‘ä¸­çš„vueç‰ˆæœ¬å°±ä¼šä¸ä¸€æ ·.

**ä»ç†è®ºä¸Šè®²ï¼ˆå¤§å®¶éƒ½éµå¾ªè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶çš„è¯ï¼‰**ï¼Œå®ƒä»¬åº”è¯¥ä»ç„¶æ˜¯å…¼å®¹çš„ï¼Œä½†ä¹Ÿè®¸ bugfix ä¼šå½±å“æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„åŠŸèƒ½ï¼Œè€Œä¸”å½“ä½¿ç”¨vueç‰ˆæœ¬3.0.0å’Œ3.0.1è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¼šäº§ç”Ÿä¸åŒçš„ç»“æœã€‚



è§£å†³æ–¹æ³•:

ä¸ºäº†è§£å†³è¿™ä¸ªä¸åŒäººç”µè„‘å®‰è£…çš„æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬éƒ½æ˜¯ä¸€è‡´çš„ï¼Œç¡®ä¿é¡¹ç›®ä»£ç åœ¨å®‰è£…æ‰€æ‰§è¡Œçš„è¿è¡Œç»“æœéƒ½ä¸€æ ·ï¼Œè¿™æ—¶ `package-lock.json` å°±åº”è¿è€Œç”Ÿäº†ã€‚





## package-lock.json

#### ä»‹ç»

`package-lock.json` å®ƒä¼š**åœ¨ npm æ›´æ”¹ node_modules ç›®å½•æ ‘ æˆ–è€… package.json æ—¶è‡ªåŠ¨ç”Ÿæˆçš„** ï¼Œå®ƒå‡†ç¡®çš„æè¿°äº†å½“å‰é¡¹ç›®npmåŒ…çš„ä¾èµ–æ ‘ï¼Œå¹¶ä¸”åœ¨éšåçš„å®‰è£…ä¸­ä¼šæ ¹æ® package-lock.json æ¥å®‰è£…ï¼Œä¿è¯æ˜¯ç›¸åŒçš„ä¸€ä¸ªä¾èµ–æ ‘ï¼Œä¸è€ƒè™‘è¿™ä¸ªè¿‡ç¨‹ä¸­æ˜¯å¦æœ‰æŸä¸ªä¾èµ–æœ‰å°ç‰ˆæœ¬çš„æ›´æ–°ã€‚

å®ƒçš„äº§ç”Ÿå°±æ˜¯æ¥å¯¹æ•´ä¸ªä¾èµ–æ ‘è¿›è¡Œç‰ˆæœ¬å›ºå®šçš„ï¼ˆé”æ­»ï¼‰ã€‚



å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­`npm install`æ—¶å€™ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª`package-lock.json`æ–‡ä»¶ï¼Œå’Œ`package.json`åœ¨åŒä¸€çº§ç›®å½•ä¸‹ã€‚`package-lock.json`è®°å½•äº†é¡¹ç›®çš„ä¸€äº›ä¿¡æ¯å’Œæ‰€ä¾èµ–çš„æ¨¡å—ã€‚

å½“æˆ‘ä»¬ä¸‹æ¬¡å†`npm install`æ—¶å€™ï¼Œnpm å‘ç°å¦‚æœé¡¹ç›®ä¸­æœ‰ `package-lock.json` æ–‡ä»¶ï¼Œä¼šæ ¹æ® `package-lock.json` é‡Œçš„å†…å®¹æ¥å¤„ç†å’Œå®‰è£…ä¾èµ–è€Œä¸å†æ ¹æ® `package.json`ã€‚



æ³¨æ„:

> æ³¨æ„ï¼Œä½¿ç”¨`cnpm install`æ—¶å€™ï¼Œå¹¶ä¸ä¼šç”Ÿæˆ `package-lock.json` æ–‡ä»¶ï¼Œä¹Ÿä¸ä¼šæ ¹æ® `package-lock.json` æ¥å®‰è£…ä¾èµ–åŒ…ï¼Œè¿˜æ˜¯ä¼šä½¿ç”¨ `package.json` æ¥å®‰è£…ã€‚



#### ç”Ÿæˆé€»è¾‘

å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸‰ä¸ª packageï¼Œåœ¨é¡¹ç›® lock-testä¸­ï¼Œå®‰è£…ä¾èµ–Aï¼ŒAé¡¹ç›®é¢æœ‰Bï¼ŒBé¡¹ç›®é¢æœ‰C

```json
// package lock-test
{ "name": "lock-test", "dependencies": { "A": "^1.0.0" }}
// package A
{ "name": "A", "version": "1.0.0", "dependencies": { "B": "^1.0.0" }}
// package B
{ "name": "B", "version": "1.0.0", "dependencies": { "C": "^1.0.0" }}
// package C
{ "name": "C", "version": "1.0.0" }
```

åœ¨è¿™ç§æƒ…å†µä¸‹ `package-lock.json`, ä¼šç”Ÿæˆç±»ä¼¼ä¸‹é¢é“ºå¹³çš„ç»“æ„

```json
// package-lock.json
{ 
    "name": "lock-test",  
    "version": "1.0.0",  
    "dependencies": {    
        "A": { "version": "1.0.0" },
        "B": { "version": "1.0.0" },
        "C": { "version": "1.0.0" }  
    }
}
```

å¦‚æœåç»­æ— è®ºæ˜¯ç›´æ¥ä¾èµ–çš„ A å‘ç‰ˆï¼Œæˆ–è€…é—´æ¥ä¾èµ–çš„B, C å‘ç‰ˆï¼Œåªè¦æˆ‘ä»¬ä¸åŠ¨ `package.json`, `package-lock.json` éƒ½ä¸ä¼šé‡æ–°ç”Ÿæˆã€‚

A å‘å¸ƒäº†æ–°ç‰ˆæœ¬ 1.1.0ï¼Œè™½ç„¶æˆ‘ä»¬ package.json å†™çš„æ˜¯ ^1.0.0 ä½†æ˜¯å› ä¸º `package-lock.json` çš„å­˜åœ¨ï¼Œnpm i å¹¶ä¸ä¼šè‡ªåŠ¨å‡çº§ï¼Œ

æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è¿è¡Œ npm i A@1.1.0 æ¥å®ç°å‡çº§ã€‚

å› ä¸º 1.1.0 `package-lock.json` é‡Œè®°å½•çš„ A@1.0.0 æ˜¯ä¸ä¸€è‡´çš„ï¼Œå› æ­¤ä¼šæ›´æ–° `package-lock.json` é‡Œçš„ A çš„ç‰ˆæœ¬ä¸º 1.1.0ã€‚

B å‘å¸ƒäº†æ–°ç‰ˆæœ¬ 1.0.1, 1.0.2, 1.1.0, æ­¤åˆ»å¦‚æœæˆ‘ä»¬ä¸åšæ“ä½œæ˜¯ä¸ä¼šè‡ªåŠ¨å‡çº§ B çš„ç‰ˆæœ¬çš„ï¼Œä½†å¦‚æœæ­¤åˆ» A å‘å¸ƒäº† 1.1.1ï¼Œè™½ç„¶å¹¶æ²¡æœ‰å‡çº§ B çš„ä¾èµ–ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬é¡¹ç›®é‡Œå‡çº§ A@1.1.1ï¼Œæ­¤æ—¶ `package-lock.json` é‡Œä¼šæŠŠ B ç›´æ¥å‡åˆ° 1.1.0 ,å› ä¸ºæ­¤åˆ»^1.0.0çš„æœ€æ–°ç‰ˆæœ¬å°±æ˜¯ 1.1.0ã€‚

ç»è¿‡è¿™äº›æ“ä½œå é¡¹ç›® lock-test çš„ package.json å˜æˆ

```json
// package 
lock-test{ "dependencies": { "A": "^1.1.0" }}
```

å¯¹åº”çš„ `package-lock.json` æ–‡ä»¶

```json
{  
    "name": "lock-test",  
    "version": "1.0.0",
    "dependencies": {  
        "A": { "version": "1.1.0" },
        "B": { "version": "1.1.0" },
        "C": { "version": "1.0.0" }
    }
}
```

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°† B åŠ å…¥æˆ‘ä»¬ lock-test é¡¹ç›®çš„ä¾èµ–, B@^1.0.0ï¼Œpackage.jsonå¦‚ä¸‹

```json
{ "dependencies": { "A": "^1.1.0", "B": "^1.0.0" }}
```

æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªæ“ä½œåï¼Œ`package-lock.json` å¹¶æ²¡æœ‰è¢«æ”¹å˜ï¼Œå› ä¸ºç°åœ¨ `package-lock.json` é‡Œ B@1.1.0 æ»¡è¶³ ^1.0.0 çš„è¦æ±‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬å°† B çš„ç‰ˆæœ¬å›ºå®šåˆ° 2.x ç‰ˆæœ¬, `package-lock.json` å°±ä¼šå‘ç”Ÿæ”¹å˜

```json
{ "dependencies": { "A": "^1.1.0", "B": "^2.0.0" }}
```

å› ä¸ºå­˜åœ¨äº†ä¸¤ä¸ªå†²çªçš„Bç‰ˆæœ¬ï¼Œ`package-lock.json` æ–‡ä»¶ä¼šå˜æˆå¦‚ä¸‹å½¢å¼

```json
{  
    "name": "lock-test",
    "version": "1.0.0",  
    "dependencies": {    
        "A": {      
            "version": "1.1.0",      
            "dependencies": {        
                "B": { "version": "1.1.0" }      
            }    
        },    
        "B": { "version": "2.0.0" },    
        "C": { "version": "1.0.0" }  
    }
}
```

å› ä¸º B çš„ç‰ˆæœ¬å‡ºç°äº†å†²çªï¼Œnpm ä½¿ç”¨åµŒå¥—æè¿°äº†è¿™ç§è¡Œä¸º

æˆ‘ä»¬å®é™…å¼€å‘ä¸­å¹¶ä¸éœ€è¦å…³æ³¨è¿™ç§ç”Ÿæˆçš„ç®—æ³•é€»è¾‘ï¼Œæˆ‘ä»¬åªéœ€è¦äº†è§£ï¼Œ`package-lock.json` çš„ç”Ÿæˆé€»è¾‘æ˜¯ä¸ºäº†èƒ½å¤Ÿç²¾å‡†çš„åæ˜ å‡ºæˆ‘ä»¬ node_modules çš„ç»“æ„ï¼Œå¹¶ä¿è¯èƒ½å¤Ÿè¿™ç§ç»“æ„è¢«è¿˜åŸã€‚



#### package-lock.jsonæ„å¤–æ›´æ”¹çš„åŸå› 

1. package.json æ–‡ä»¶ä¿®æ”¹äº†
2. æŒªåŠ¨äº†åŒ…çš„ä½ç½®

å°†éƒ¨åˆ†åŒ…çš„ä½ç½®ä» dependencies ç§»åŠ¨åˆ° devDependencies è¿™ç§æ“ä½œï¼Œè™½ç„¶åŒ…æœªå˜ï¼Œä½†æ˜¯ä¹Ÿä¼šå½±å“ `package-lock.json`ï¼Œä¼šå°†éƒ¨åˆ†åŒ…çš„ dev å­—æ®µè®¾ç½®ä¸º true

3. registry çš„å½±å“

ç»è¿‡å®é™…ä½¿ç”¨å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬ node_modules æ–‡ä»¶å¤¹ä¸‹çš„åŒ…ä¸­ä¸‹è½½æ—¶ï¼Œå°±ç®—ç‰ˆæœ¬ä¸€æ ·ï¼Œå®‰è£…æº `registry` ä¸åŒï¼Œæ‰§è¡Œ npm i æ—¶ä¹Ÿä¼šä¿®æ”¹ package-lock.json



å¯èƒ½è¿˜å­˜åœ¨å…¶ä»–çš„åŸå› ï¼Œä½†æ˜¯ `package-lock.json` æ˜¯ä¸ä¼šæ— ç¼˜æ— æ•…è¢«æ›´æ”¹çš„ï¼Œä¸€å®šæ˜¯å› ä¸º **package.json æˆ–è€… node_modules è¢«æ›´æ”¹äº†**ï¼Œå› ä¸º æ­£å¦‚ä¸Šé¢æåˆ°çš„ package-lock.json ä¸ºäº†èƒ½å¤Ÿç²¾å‡†çš„åæ˜ å‡ºæˆ‘ä»¬ node_modules çš„ç»“æ„



#### å¼€å‘å»ºè®®

ä¸€èˆ¬æƒ…å†µä¸‹ `npm install` æ˜¯å¯ä»¥çš„ï¼Œä»–èƒ½ä¿è¯æ ¹æ® `package-lock.json` è¿˜åŸå‡ºå¼€å‘æ—¶çš„ `node_modules`ã€‚

ä½†æ˜¯ä¸ºäº†é˜²æ­¢å‡ºç°åˆšåˆšæåˆ°çš„æ„å¤–æƒ…å†µï¼Œé™¤éæ¶‰åŠåˆ°å¯¹åŒ…çš„è°ƒæ•´ï¼Œå…¶ä»–æƒ…å†µä¸‹å»ºè®®ä½¿ç”¨ `npm ci `æ¥å®‰è£…ä¾èµ–ï¼Œä¼šé¿å…å¼‚å¸¸çš„ä¿®æ”¹ `package-lock.json`ï¼Œ

æŒç»­é›†æˆå·¥å…·ä¸­æ›´æ¨èæ˜¯ç”¨ `npm ci`ï¼Œä¿è¯`æ„å»ºç¯å¢ƒçš„å‡†ç¡®æ€§`ï¼Œ**npm i å’Œ npm ci çš„åŒºåˆ«** å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ npm-ci









### ä½¿ç”¨æµç¨‹

```js
- åœ¨é¡µé¢ä¸­ç›´æ¥è°ƒç”¨åœ°å€
1.ä¸‹è½½åˆ°æœ¬åœ°
2.é¡µé¢ä¸­ä½¿ç”¨é“¾æ¥å¼•å…¥

- nodeç¯å¢ƒä¸‹å¦‚ä½•ä½¿ç”¨

//å¼•å…¥lodashåŒ…
const _=require('lodash');
console.log(_.random(1, 100));
//nodeè°ƒç”¨jsæ–‡ä»¶


- å…¶ä»–:
åŒ…æ˜¯å­˜åœ¨ä¾èµ–çš„,ä¸‹è½½ä¸€ä¸ªåŒ…,å¯èƒ½åœ¨ä¸‹è½½äº†å¤šä¸ªåŒ…
```



#### å›¢é˜Ÿå¼€å‘ä½¿ç”¨æµç¨‹

```js
# node_modulesæ–‡ä»¶å¤¹æ˜¯ä¸è¿›å…¥gitä»“åº“çš„,éœ€è¦åœ¨.gitignoreä¸­å¿½ç•¥.
# è¿œç«¯ä»“åº“ å¼ºæ¨ä¼šè¦†ç›–è¿œç«¯ä»“åº“å†…å®¹, è¯­æ³•: git push -u origin master -f

1. ä»ä»“åº“ä¸­æ‹‰å–ä»“åº“ä»£ç  //git clone è¿œç«¯åœ°å€
2. è¿è¡Œ npm install å®‰è£…ç›¸å…³ä¾èµ– //npm i
3. è¿è¡Œé¡¹ç›®ï¼Œç»§ç»­å¼€å‘


```







```js
npm -version/-v
npm init/i åˆå§‹åŒ–
npm i --yes ç®€æ´å†™æ³• å…¨éƒ¨é‡‡ç”¨é»˜è®¤å€¼,ä½†ä¸Šçº§è·¯å¾„ä¸­ä¸èƒ½å­˜åœ¨ä¸­æ–‡
npm search/s name æœç´¢åŒ…
npm install/i name å®‰è£…åŒ…

//å®‰è£…åˆ°ä¾èµ–ä¸­  åŒ…åä¼šè¢«æ³¨å†Œåœ¨package.jsonä¸­çš„dependenciesé‡Œé¢,åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹è¿™ä¸ªåŒ…çš„ä¾èµ–ä¾ç„¶å­˜åœ¨.
//å®‰è£…åŒ…å¹¶æ·»åŠ åˆ°ç”Ÿäº§ä¸­(devdependencies)  6ç‰ˆæœ¬å¯çœç•¥,è‡ªåŠ¨æ·»åŠ åˆ°ä¾èµ–ä¸­
npm i name --save-dev
npm i name -D

//å®‰è£…åŒ…å¹¶æ·»åŠ åˆ°å¼€å‘ä¸­(dependencies)
//
npm i name --save
npm i name -S


npm i name -g å…¨å±€å®‰è£…

npm i/install  å®‰è£…å…¨éƒ¨ä¾èµ–
npm i --production åªå®‰è£…dependenciesä¸­çš„ä¾èµ–

npm remove/r name1 name2 ç§»é™¤åŒ…,å¯ä»¥æ·»åŠ å¤šä¸ªåŒ…çš„åå­—
```



### å°è£… NPM åŒ…

åˆ›å»ºè‡ªå·±çš„ NPM åŒ…å¯ä»¥å¸®åŠ©ä»£ç è¿›è¡Œè¿­ä»£è¿›åŒ–ï¼Œä½¿ç”¨æ­¥éª¤ä¹Ÿæ¯”è¾ƒç®€å•

0. ä¿®æ”¹ä¸ºå®˜æ–¹çš„åœ°å€ (npm config set registry https://registry.npmjs.org/) ä½¿ç”¨éå®˜æ–¹åœ°å€æ—¶æ‰è¦(æ·˜å®é•œåƒæ‰ä½¿ç”¨æ­¤æ­¥)

1. åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»ºæ–‡ä»¶ **index.js**ï¼Œ åœ¨æ–‡ä»¶ä¸­å£°æ˜å‡½æ•°ï¼Œä½¿ç”¨ module.exports æš´éœ²
2. æ–‡ä»¶å¤¹ä¸‹ npm åˆå§‹åŒ–å·¥å…·åŒ…(npm init)ï¼Œpackage.json å¡«å†™åŒ…çš„ä¿¡æ¯
3. è´¦å·æ³¨å†Œï¼ˆæ¿€æ´»è´¦å·ï¼‰,==å®Œæˆé‚®ç®±éªŒè¯==
4. æ–‡ä»¶å¤¹ä¸‹,å‘½ä»¤è¡Œä¸‹ ã€npm loginã€ å¡«å†™ç›¸å…³ç”¨æˆ·ä¿¡æ¯
5. æ–‡ä»¶å¤¹ä¸‹, å‘½ä»¤è¡Œä¸‹ã€ npm publishã€ æäº¤åŒ… ğŸ‘Œ

> npm æœ‰åƒåœ¾æ£€æµ‹æœºåˆ¶ï¼Œå¦‚æœåå­—ç®€å•æˆ–åšæµ‹è¯•æäº¤ï¼Œå¾ˆå¯èƒ½ä¼šè¢«æ‹’ç»æäº¤
>
> ==å¯ä»¥å°è¯•æ”¹ä¸€ä¸‹åŒ…çš„åç§°æ¥è§£å†³è¿™ä¸ªé—®é¢˜==



### å‡çº§npmåŒ…

å‡çº§ NPM åŒ…ï¼Œéœ€è¦ä¿®æ”¹ package.json ä¸­çš„ç‰ˆæœ¬å·ä¿®æ”¹ï¼Œåªéœ€è¦æ‰§è¡Œã€npm publishã€å°±å¯ä»¥èƒ½æäº¤

1. ä¿®æ”¹åŒ…ä»£ç 
2. ä¿®æ”¹ package.json ä¸­ç‰ˆæœ¬å·
3. npm publish æäº¤

### åˆ é™¤ npm åŒ…

```
npm unpublish åŒ…å --force
```








## å¸¸è§é—®é¢˜

### åˆå§‹åŒ–é¡¹ç›®,node-sassä¸‹è½½å¤±è´¥

> [node-sasså®‰è£…å¤±è´¥è§£å†³æ–¹æ³•æ±‡æ€» Â· Issue #311 Â· iuap-design/blog (github.com)](https://github.com/iuap-design/blog/issues/311)

æŠ¥é”™ä¿¡æ¯
```bash
Downloading binary from https://github.com/sass/node-sass/releases/download/v4.11.0/win32-x64-72_binding.node
Cannot download "https://github.com/sass/node-sass/releases/download/v4.11.0/win32-x64-72_binding.node":

HTTP error 404 Not Found

Hint: If github.com is not accessible in your location
      try setting a proxy via HTTP_PROXY, e.g.

      export HTTP_PROXY=http://example.com:1234

or configure npm proxy via

      npm config set proxy http://example.com:8080
```

æ ¹æ®æŠ¥é”™æç¤º,å¯ä»¥é€šè¿‡æ·»åŠ ä»£ç†çš„æ–¹å¼æ¥è§£å†³é—®é¢˜.ä½†æ˜¯æ·»åŠ ä»£ç†åä¾ç„¶ä¼šæŠ¥é”™. å› ä¸ºè¯·æ±‚çš„åœ°å€è¿”å›çš„404, è¿™ä¸ªé¡µé¢æ˜¯ä¸ªç©ºé¡µé¢.

ç¨³é‡æåˆ°äº†3ç§è§£å†³æ–¹æ¡ˆ,æˆ‘ä»¬è¿™é‡Œåªé‡‡ç”¨ç¬¬ä¸‰ç§æ›´æ”¹ç‰¹å®šæ¨¡å—æ·˜å®é•œåƒçš„æ–¹æ³•:

```bash
npm set sass_binary_site=https://npm.taobao.org/mirrors/node-sass/

//or

npm i cnpm -g --registry=https://registry.npmmirror.com
cnpm i node-sass
```



### npmä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤
> ä½¿ç”¨npmæŠ¥é”™:npmä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤,ä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº
> is not recognized as an internal or external command

> [å…³äºå±€éƒ¨å®‰è£…npmæ¨¡å—æ‰¾ä¸åˆ°å‘½ä»¤çš„é—®é¢˜åˆ†æåŠè§£å†³æ–¹æ¡ˆ_ç¥ä¸€æ ·çš„ç”·äºº000çš„åšå®¢-CSDNåšå®¢_npm run build:stage æœªæ‰¾åˆ°å‘½ä»¤](https://blog.csdn.net/qq_21998595/article/details/80460673)

æˆ‘ä»¬å®‰è£…å®ŒåŒ…åæ‰§è¡Œçš„å‘½ä»¤, å…¶ä½ç½®æ˜¯åœ¨node_modulesä¸­çš„`.bin`æ–‡ä»¶å¤¹ä¸­, å¦‚æœæ˜¯å…¨å±€å®‰è£…çš„è¯, å…¶æ–‡ä»¶å¤¹ä¸­çš„å„ä¸ªå‘½ä»¤æ‰§è¡Œæ–‡ä»¶å¯ä»¥è¢«è¯†åˆ«, ä½†å±€éƒ¨å®‰è£…çš„å°±æ— æ³•åˆ«è¯†åˆ«.

æ‰€ä»¥è§£å†³æ–¹æ³•:(æ¨èç¬¬ä¸‰ç§)

1.åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡Pathä¸­æ·»åŠ å±€éƒ¨`node_modules/.bin`çš„è·¯å¾„  æˆ– ä½¿ç”¨`npx npm ...`å‘½ä»¤. æ­¤å‘½ä»¤ä¼šåœ¨æ‰§è¡Œæ—¶å°†å…¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­

2.åœ¨å½“å‰ç›®å½•ç¯å¢ƒä¸‹ä½¿ç”¨å‘½ä»¤ `C:\...\node_modules\.bin\è„šæœ¬åç§° ç›®æ ‡æ–‡ä»¶`è¿™ç§å½¢å¼

3.åœ¨package.jsonä¸­é…ç½®scriptsé¡¹, ç›¸å½“äºå°†å‘½ä»¤è¡Œè¯­å¥ä¿å­˜ä¸‹æ¥ï¼Œä¹‹ååªè¦è¿è¡Œç®€å•çš„å‘½ä»¤ç±»ä¼¼ï¼šnpm run buildï¼Œå°±å¯ä»¥å®ç°äº†ã€‚

```js
{
  "scripts": {
    "js": "josn-server --watch db.json"
    //"js": "json-server --watch" å¯ä»¥çµæ´»æŒ‡å®šæ–‡ä»¶
  },
  "dependencies": {
    "json-server": "^0.17.1"
  }
}
```



### 3000ç«¯å£è¢«å ç”¨,æ‹’ç»è®¿é—®(todo)

> [http - Node.js EACCES error when listening on most ports - Stack Overflow](https://stackoverflow.com/questions/9164915/node-js-eacces-error-when-listening-on-most-ports)

```sh
net stop winnat


net start winnat
```



### å‡çº§æŒ‡å®šå­ä¾èµ–çš„ç‰ˆæœ¬å·
å›ºå®šç‰ˆæœ¬ å›ºå®šnpmä¾èµ–ç‰ˆæœ¬
> https://www.cnblogs.com/hanshuai/p/16880792.html
> https://juejin.cn/post/7163150684747989005
> https://juejin.cn/post/7205181884590276669
> https://juejin.cn/post/7302439422671208483


### CNPM

#### ä»‹ç»

cnpm æ˜¯æ·˜å®å¯¹å›½å¤– npm æœåŠ¡å™¨çš„ä¸€ä¸ªå®Œæ•´é•œåƒç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯æ·˜å® npm é•œåƒï¼Œç½‘ç«™åœ°å€:

* æ—§åœ°å€ http://npm.taobao.org/  (2022.05.31åˆ°æœŸ)
* æ–°åœ°å€ https://npmmirror.com

#### å®‰è£…

å®‰è£…é…ç½®æ–¹å¼æœ‰ä¸¤ç§

* npm install -g cnpm --registry=https://registry.npmmirror.com
* alias cnpm="npm --registry=https://registry.npmmirror.com \
  --cache=$HOME/.npm/.cache/cnpm \
  --disturl=https://registry.npmmirror.com/dist \
  --userconfig=$HOME/.cnpmrc"       (åªèƒ½åœ¨Linuxä¸‹ä½¿ç”¨)

#### ä½¿ç”¨

é…ç½®å®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨ cnpm å‘½ä»¤æ¥ç®¡ç†åŒ…ï¼Œä½¿ç”¨æ–¹æ³•è·Ÿ npm ä¸€æ ·

```sh
cnpm install lodash
```

#### npm é…ç½®æ·˜å®é•œåƒåœ°å€

```sh
//æŸ¥çœ‹é…ç½®çš„é•œåƒ
npm get registry

//æ·˜å®é•œåƒ
npm config set registry https://registry.npmmirror.com
//å®˜æ–¹é•œåƒ   
npm config set registry https://registry.npmjs.org/

```

> åœ¨å‘å¸ƒå·¥å…·çš„æ—¶å€™, ä¸€å®šè¦å°†ä»“åº“åœ°å€, ä¿®æ”¹ä¸ºå®˜æ–¹çš„åœ°å€

### Yarn

#### ä»‹ç»

yarn æ˜¯ Facebook å¼€æºçš„æ–°çš„åŒ…ç®¡ç†å™¨ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿ npmã€‚

#### ç‰¹ç‚¹

yarn ç›¸æ¯”äº npm æœ‰å‡ ä¸ªç‰¹ç‚¹

* æœ¬åœ°ç¼“å­˜ã€‚å®‰è£…è¿‡çš„åŒ…ä¸‹æ¬¡ä¸ä¼šè¿›è¡Œè¿œç¨‹å®‰è£…
* å¹¶è¡Œä¸‹è½½ã€‚ä¸€æ¬¡ä¸‹è½½å¤šä¸ªåŒ…ï¼Œè€Œ npm æ˜¯ä¸²è¡Œä¸‹è½½
* ç²¾å‡†çš„ç‰ˆæœ¬æ§åˆ¶ã€‚ä¿è¯æ¯æ¬¡å®‰è£…è·Ÿä¸Šæ¬¡éƒ½æ˜¯ä¸€æ ·çš„

#### å®‰è£…

##### yarn å®‰è£…: å‘½ä»¤è¡Œ+å®‰è£…åŒ…

åªéœ€è¦ä¸€è¡Œå‘½ä»¤å³å¯å®‰è£… yarn, ç¼ºç‚¹:yarnå…¨å±€å‘½ä»¤ä¸ç”Ÿæ•ˆ è§£å†³:æ·»åŠ pathå˜é‡

```sh
npm install yarn -g
```

##### msi å®‰è£…åŒ…å®‰è£…

<https://classic.yarnpkg.com/en/docs/install#windows-stable>

#### ç›¸å…³å‘½ä»¤

yarn çš„ç›¸å…³å‘½ä»¤

1)  yarn --version //yarn -v

2)  yarn init  //ç”Ÿæˆpackage.json   

3)  yarn global add  packageName (å…¨å±€å®‰è£…)

â€‹	å…¨å±€å®‰è£…è·¯å¾„ `C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Yarn\bin`

4)  yarn global remove less (å…¨å±€åˆ é™¤)

5)  yarn add packageName (å±€éƒ¨å®‰è£…)  //å®‰è£…åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„node_modulesæ–‡ä»¶å¤¹

6)  yarn add package --dev (å¼€å‘ä¾èµ– ç›¸å½“äºnpmä¸­çš„--save-dev)

7)  yarn (global) remove package  ç§»é™¤å‘½ä»¤

8)  yarn list //åˆ—å‡ºå·²ç»å®‰è£…çš„åŒ…å ç”¨çš„å¾ˆå°‘

9)  yarn info packageName //è·å–åŒ…çš„æœ‰å…³ä¿¡æ¯  å‡ ä¹ä¸ç”¨

10)  yarn //å®‰è£…package.jsonä¸­çš„æ‰€æœ‰ä¾èµ–  å’Œnpm içš„ä½œç”¨ä¸€æ ·



> npm 5 å¼•å…¥ç¦»çº¿ç¼“å­˜ï¼Œæé«˜äº†å®‰è£…é€Ÿåº¦ï¼Œä¹Ÿå¼•å…¥äº† package-lock.json æ–‡ä»¶å¢å¼ºäº†ç‰ˆæœ¬æ§åˆ¶

yarn ä¿®æ”¹ä»“åº“åœ°å€

```sh
yarn config set registry https://registry.npm.taobao.org
```

### CYarn

è·Ÿ npm ä¸ cnpm çš„å…³ç³»ä¸€æ ·ï¼Œå¯ä»¥ä¸º yarn è®¾ç½®å›½å†…çš„æ·˜å®é•œåƒï¼Œæå‡å®‰è£…çš„é€Ÿåº¦. åŸºæœ¬ä¸Šç”¨ä¸ç€

```sh
npm install cyarn -g --registry "https://registry.npm.taobao.org"
```

é…ç½®åï¼Œåªéœ€å°†yarnæ”¹ä¸ºcyarnä½¿ç”¨å³å¯

### bower

```js
ä¸‹è½½å,ä½¿ç”¨linkæ ‡ç­¾å¼•ç”¨
```



### å±€éƒ¨è£…å’Œå…¨å±€å®‰è£…

```js
- å±€éƒ¨å®‰è£…è¾ƒå¤š
- å…¨å±€å®‰è£…(ç‰¹å®šçš„)æœ‰: cnpm nodemon 
```







### é™„å½•

### å…³äºç‰ˆæœ¬å·

ç‰ˆæœ¬æ ¼å¼ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·

* "^3.0.0" ï¼šé”å®šä¸»ç‰ˆæœ¬ï¼Œä»¥åå®‰è£…åŒ…çš„æ—¶å€™ï¼Œä¿è¯åŒ…æ˜¯3.x.xç‰ˆæœ¬ï¼Œxé»˜è®¤å–æœ€æ–°çš„ã€‚
* "~3.2.x" ï¼šé”å®šå°ç‰ˆæœ¬ï¼Œä»¥åå®‰è£…åŒ…çš„æ—¶å€™ï¼Œä¿è¯åŒ…æ˜¯3.1.xç‰ˆæœ¬ï¼Œxé»˜è®¤å–æœ€æ–°çš„ã€‚
* "3.1.1" ï¼šé”å®šå®Œæ•´ç‰ˆæœ¬ï¼Œä»¥åå®‰è£…åŒ…çš„æ—¶å€™ï¼Œä¿è¯åŒ…å¿…é¡»æ˜¯3.1.1ç‰ˆæœ¬ã€‚

å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„å·¥å…·åŒ…

```shell
yarn add jquery@1.11.2
```

#### npm æ¸…é™¤ç¼“å­˜

```
npm cache clean
```







### æ¨¡å—åŒ–

#### ç»„ä»¶åŒ–å¥½å¤„

```
1.å¤ç”¨æ€§
2.ç»´æŠ¤æ€§
```



### ä»‹ç»

æ¨¡å—åŒ–æŒ‡çš„å°±æ˜¯å°†ä¸€ä¸ªå¤§çš„åŠŸèƒ½æ‹†åˆ†ä¸ºä¸€ä¸ªä¸€ä¸ªå°çš„æ¨¡å—ï¼Œé€šè¿‡ä¸åŒçš„æ¨¡å—çš„ç»„åˆæ¥å®ç°ä¸€ä¸ªå¤§åŠŸèƒ½ã€‚

- åœ¨nodeä¸­ä¸€ä¸ª js æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—
- æ¨¡å—å†…éƒ¨ä»£ç å¯¹äºå¤–éƒ¨æ¥è¯´éƒ½æ˜¯ä¸å¯è§çš„ï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å‘å¤–éƒ¨æš´éœ²

### æ¨¡å—åˆ›å»º

```js
åœ¨æ¨¡å—JSæ–‡ä»¶ä¸­ä½¿ç”¨module_exportsæš´éœ²éœ€è¦å¼•å…¥çš„å¯¹è±¡
```



åœ¨æ–‡ä»¶ä¸­å¯¹å¤–æš´éœ²çš„ä¸¤ç§æ–¹æ³•: **module_exports=æ¨¡å—  exports.æ¨¡å—**

```js
function test(){
    return 11;
}

//exports=module.exports={
//ä¸€ä¸ªå¯¹è±¡
module.exports = test;
}

//å¤šä¸ªå¯¹è±¡ ES6å¯¹è±¡è¯­æ³•=
module.exoprts={
    test,
    test2
}
=========ç¬¬äºŒç§==============
exports.test=test;
exports.test2=test2;
```

è¿™é‡Œæœ‰å‡ ç‚¹æ³¨æ„ï¼š

* module.exports å¯ä»¥æš´éœ²ä»»æ„æ•°æ®
* å¯ä»¥ä½¿ç”¨ module.exports æš´éœ²å¤šä¸ªæ•°æ®
* exports ä¹Ÿå¯ä»¥æš´éœ²æ•°æ®ï¼Œä¸è¿‡ä¸èƒ½ä½¿ç”¨ `exports = xxx` çš„å½¢å¼
* requireè¿”å›çš„æ˜¯ç›®æ ‡æ¨¡å—module.exportsçš„å€¼





### æ¨¡å—å¼•å…¥

ä½¿ç”¨ require å¼•å…¥æ–‡ä»¶å³å¯

```js
var test = require('./test.js');  
//è·¯å¾„é—®é¢˜: å¼•å…¥æ–‡ä»¶æ—¶, æ— éœ€ä½¿ç”¨ç»å¯¹è·¯å¾„.å†™ç›¸å¯¹è·¯å¾„å°±å¯ä»¥,å³ä½¿æ›´æ”¹ä½ç½®,ä¹Ÿä¸ä¼šäº§ç”Ÿå½±å“.
//require è¿”å›çš„æ˜¯ç›®æ ‡æ¨¡å— module.exports çš„å€¼
åŸå§‹å¤šä¸ªç±»å‹
```

è¿™é‡Œæœ‰å‡ ç‚¹æ³¨æ„ï¼š

* å¦‚æœæ²¡æœ‰åŠ æ–‡ä»¶åç¼€ï¼Œä¼šæŒ‰ç…§ä»¥ä¸‹åç¼€çš„**é¡ºåº**æ¥åŠ è½½æ–‡ä»¶
  * .js    fsæ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶ç¼–è¯‘æ‰§è¡Œ
  * .json  fsæ¨¡å—åŒæ­¥è¯»å–æ–‡ä»¶ï¼Œç”¨JSON.parse()è§£æè¿”å›ç»“æœ. å¿…é¡»ä½¿ç”¨åŒå¼•å·,æœ€åä¸€ä¸ªä¸å†™é€—å·
  * .node è¿™æ˜¯c/c++ç¼–å†™çš„æ‰©å±•æ–‡ä»¶ï¼Œé€šè¿‡dlopen()æ–¹æ³•ç¼–è¯‘
* å…¶ä»–æ‰©å±•å  ä¼šä»¥.jsæ–‡ä»¶è½½å…¥
* å¦‚æœæ˜¯æ–‡ä»¶å¤¹åˆ™ä¼šé»˜è®¤åŠ è½½è¯¥æ–‡ä»¶å¤¹ä¸‹ package.json æ–‡ä»¶ä¸­ main å±æ€§å¯¹åº”çš„æ–‡ä»¶   npm init --yes
* å¦‚æœ main å±æ€§å¯¹åº”çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨æ‰¾ index.js  index.json 
* å¦‚æœæ˜¯å†…ç½®æ¨¡å—æˆ–è€…æ˜¯ npm å®‰è£…çš„æ¨¡å—ï¼Œç›´æ¥ä½¿ç”¨åŒ…åå­—å³å¯ //ä¾‹å¦‚http, fs
* npm å¼•å…¥åŒ…æ—¶ï¼Œå¦‚æœå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ node_modules æ²¡æœ‰ï¼Œåˆ™ä¼šè‡ªåŠ¨å‘ä¸ŠæŸ¥æ‰¾

### ç®€åŒ–

å¼•å…¥

```js
ä¸‹è½½åˆ°æœ¬åœ°çš„åŒ… äº†è§£

const _ = require('./node_modules/lodash/lodash.js');
const _ = require('./node_modules/lodash/');
```



å¯¼å‡º

```
module.exports       
```

å¯¼å…¥

```
var res = require('./module.js');
var name=require('name');
```



