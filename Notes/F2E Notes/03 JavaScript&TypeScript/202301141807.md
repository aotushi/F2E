---
aliases: js词法结构
---


## 词法结构

> 编程语言的词法结构是一套基本规则,规定了如何使用这门语言编写程序.
>
> 词法结构是一门语言最低级的语法,规定了变量如何命名/注释的定界符/以及如何分割程序的语句等等.

* 区分大小写,空格和换行符
* 注释
* 字面量
* 标识符和保留字
* Unicode
* 可选的分号



### JS程序的文本

JS区分大小写, 意味着它的关键字, 变量, 函数名和其他标识符必须始终保持一致的大小写形式.

JS忽略程序记号(token)之间的空格.很大程度上,也忽略换行符. 可以在程序中随意使用空格和换行,可以按照便于理解的方式对程序进行格式化和缩进.

除了常规空格(`\u0020`), JS也将制表符, 各种ASCII控制符和Unicode间隔识别为空格.

将换行符, 回车符和回车换行识别为行终止符.



#### 回车和换行

> [回车和换行 - 阮一峰的网络日志 (ruanyifeng.com)](https://www.ruanyifeng.com/blog/2006/04/post_213.html)

**来历**

打字机

回车(carriage return) : 原意是光标回到本行的开头

换行(line feed):光标往下一行,不一定是行首.

**表现**

Unix系统里，每行结尾只有"<换行>"，即"`\n`"；

Windows系统里面，每行结尾是"<回车><换行>"，即"`\r\n`"；

Mac系统里，每行结尾是"<回车>", `r`

一个直接后果是，Unix/Mac系统下的文件在Windows里打开的话，所有文字会变成一行；而Windows里的文件在Unix/Mac下打开的话，在每行的结尾可能会多出一个^M符号。



### 注释

JS支持两种注释: 单行注释,多行注释

单行注释:

 以`//`开头到一行末尾的内容

多行注释:

多行注释位于`/*`和`*/`之间,可以跨行,但不能嵌套.



### 字面量

> 字面量(literal)是一种直接出现在程序中的数据量.

```javascript
12
1.2
'hello world'
'Hi'
true
false
null
```



### 标识符和保留字

#### 标识符

标识符就是一个名字. 在JS中,标识符用于在JS代码中命名常量,变量,属性,函数和类,以及为某些循环提供标记(label).

#### 命名规则

必须以字母, 下划线或美元符号开头, 数字不能作为第一个字符,以便JS区分标识符和数值.



### Unicode

JS程序是使用Unicode字符集编写的,因为在字符串和主时钟可以使用任意Unicode字符.

考虑到可以执行和易于编辑,建议在标识符中只是用ASCII字母和数字.

#### Unicode转义序列

某些计算机硬件和软件无法显示,输入或正确处理全部Unicode字符, 为了编码和支持使用老技术的系统,JS定义了转义序列,从而可以仅使用ASCII字符来表示Unicode字符. ^7c5949

这些Unicode字符以`\u`开头,后跟4位16进制数字或包含在一对花括号内的1~6位十六进制数字.

Unicode转义序列可以出现在JS字符串字面量, 正则表达式字面量和标识符中(不能出现在语言关键字中).

例如:

字符 `é` 的Unicode转义序列是`\u00E9`,以下是3种在变量种使用这个字符的示例:

```javascript
let café = 1; //使用Unicode字符定义一个变量
caf\u0009  // => 1; 使用转义序列访问这个变量
caf\u{E9}  // => 1; 相同转义序列的另一种形式
```

JS转义序列带大括号的版本是ES6新增的,为了更好的支持大于16位的Unicode码点,比如表情符号:

```javascript
console.log('u\{1F600}')
```

注释中的Unicode转义序列会被当做ASCII字符处理,不会被解释为Unicode

#### Unicode归一化

Unicode允许用多种编码方式表示同一个字符.

例如: 字符`é`可以被编码为一个Unicode字符`\u00E9`, 也可以被编码为一个常规ASCII字符'e'后跟一个重音组合标记`u\0301`.  这两种编码在文本编辑器中看起来完全相同,但他们的二进制编码不同,因为JS认为它们不同,这会导致很大的问题:

```javascript
const café = 1; //这个常量名为'caf\u{e9}'
const café = 2; //这个常量名为'cafe\u{301}'

café //1
café //2
```



Unicode标准为所有字符定义了首选编码并规定了归一化例程,用于把文本转换为适合比较的规范形式. JS假定自己解释的源代码已经归一化,它自己不会执行任何归一化.

如果你想在JS程序中使用Unicode字符,应该保证使用自己的编辑器或其他工具对自己的源代码执行Unicode归一化,以防其中包含看起来一样但实际不同的标识符.



### 可选的分号

JS使用分号(`;`)分隔语句.

在JS中,如果两条语句分别写在两行,通常可以省略它们之间的分号.

在程序末尾,如果接下来的记号是右花括号, 也可以省略分号.

**代码风格:**

一种使用分号明确标识语句结束,即便这些分号并非必须

另一种风格是尽可能省略分号,只在少数必要情况下采用.

**换行符 不一定等于 分号**

JS并非在任何时候都把换行符当做分号,而只是在不隐式添加分号就无法解析代码的情况下才这么做.具体来说,JS只在下一个非空格字符无法被解释为当前语句的一部分时才把换行符当做分号.

```javascript
let a
a
=
3
console.log(a)
```

JS将以上代码解析为:

```javascript
let a; a=3; console.log(a)
```

之所以把第一个换行符当做分号,是因为如果没有分号,JS就无法解析代码`let a a`.第二个a本身就是一条独立语句,但JS并没有把第二个换行符当做分号,是因为还可以继续解析更长的语句..

**防御性分号**

注意事项:

通常,如果语句以`(, [, /, +, -`其中任一开头,就有可能被解析为之前语句的一部分.实践中,以`/, +, -`开头的语句极少,但以`(, [`开头的语句不在少数.可以看到有的程序员在所有这种语句前面防御性的添加一个分号,这样即使前面的的语句被修改,删掉了之前末尾的分号,也不会影响当前语句:

```Javascript
let x = 0 //省略分号
;[x, x+1, x+2].forEach(console.log) //防御:保证这条语句的独立
```

3**种例外**

JS在不能把第二行解析为第一行的连续部分时,对换行符的解释有三种例外.

第一种: 涉及return, throw, yield, break, continue,这些语句经常独立存在,但有时后面也跟一个标识符或表达式.如果这几个单词后面有换行符,JS就会把这个换行符解释为分号. 这意味着一定不能在return, break, continue等关键字和它们后面的表达式之间加入换行符.

第二种: 涉及`++` 和 `--`操作符.如果当做后置操作符,那么必须与自己操作的表达式位于同一行.

第三种: 简洁箭头语法定义的函数, 箭头必须跟参数列表在同一行.

